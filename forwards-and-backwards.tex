\documentclass[12pt]{article}
\usepackage{fullpage}
\usepackage{amssymb}
\usepackage{graphics} 
\usepackage{amsmath}
\usepackage[color=yellow]{todonotes}
\usepackage{url}

\usepackage{xcolor}
\usepackage{longtable}
\usepackage[hidelinks]{hyperref}
\usepackage{bbm}

\usepackage{natbib}

\newenvironment {proof}{{\noindent\bf Proof }}{\hfill $\Box$ \medskip}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{condition}[theorem]{Condition}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{hypothesis}[theorem]{Hypothesis}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{example}[theorem]{Example}
\newtheorem{definition}[theorem]{Definition}

\renewcommand{\theequation}{\arabic{section}.\arabic{equation}}
\def \non{{\nonumber}}
\def \hat{\widehat}
\def \tilde{\widetilde}
\def \bar{\overline}
\newcommand{\IP}{\mathbb P}
\newcommand{\IQ}{\mathbb Q}
\newcommand{\IE}{\mathbb E}
\newcommand{\IR}{\mathbb R}
\newcommand{\IZ}{\mathbb Z}
\newcommand{\IN}{\mathbb N}
\newcommand{\IT}{\mathbb T}
\newcommand{\IC}{\mathbb C}
\newcommand{\ind}{\mathbf{1}}
\newcommand{\bigO}{\mathcal{O}}
\newcommand{\grad}{\nabla}

%%%%%%% notation
\newcommand{\DG}{\mathcal{B}}  % generator of the dispersal process
\newcommand{\meanq}{\vec b}    % mean of dispersal, times theta
\newcommand{\covq}{\Sigma}     % covariance matrix of dispersal, times theta
\newcommand{\kernel}{\varrho}  % interaction kernels
\newcommand{\smooth}[1]{\kernel_{#1} \! * \!}  % convolution by the interaction kernel
\newcommand{\wavespeed}{\mathfrak{c}}    % speed (vector) of a wave
\newcommand{\Lgen}{\mathcal{L}}    % generator of a lineage
\newcommand{\Pgen}{\mathcal{P}}    % generator of the population process


\newcommand{\plr}[1]{\todo[inline]{Peter: #1}}
\newcommand{\comment}[1]{{\color{blue} \it #1}}

\begin{document}

\title{\large{\bf
Looking forwards and backwards through locally regulated populations
}}

% OTHER IDEAS:
% A class of nonlinear superprocesses
% Uncovering genealogical structures of locally regulated populations with lookdown constructions on nonlinear superprocesses
                                                       
\author{ \begin{small}
\begin{tabular}{ll}                              
Alison M. Etheridge 
 & Thomas G. Kurtz \\   
Department of Statistics & Departments of Mathematics and Statistics\\       
Oxford University & University of Wisconsin - Madison \\                   
24-29 St Giles & 480 Lincoln Drive\\                                                         
Oxford OX1 3LB & Madison, WI  53706-1388\\
UK & USA \\                        
etheridg@stats.ox.ac.uk & kurtz@math.wisc.edu     \\
\url{http://www.stats.ox.ac.uk/~etheridg/} & 
\url{http://www.math.wisc.edu/~kurtz/}  \\       \\
\\
Ian Letter&  Peter L. Ralph 
\\   
Department of Statistics & Department of Mathematics \\
Oxford University &University of Oregon\\                   
24-29 St Giles & Fenton Hall\\
Oxford OX1 3LB & Eugene, OR 97403-1222\\
UK & USA \\
restucci@stats.ox.ac.uk  & plr@oregon.edu \\
\url{https://www.stats.ox.ac.uk/~restucci/}&
\url{https://math.uoregon.edu/profile/plr} \\
\\
Terence Tsui 
 &  \\   
Department of Statistics & \\
Oxford University & \\                   
24-29 St Giles& \\
Oxford OX1 3LB & \\
UK & \\
terence.tsui@sjc.ox.ac.uk &      \\
\url{https://www.maths.ox.ac.uk/people/terence.tsui}&  \\
\end{tabular}
\end{small}}

\date{\today}
\maketitle


\begin{abstract}

We do something...

\vspace{.1in}


\noindent {\bf Key words:}  population model, nonlinear superprocess, 
lookdown construction, porous medium equation, 
reaction-diffusion equation, travelling waves, genealogies,


\vspace{.1in}



\noindent {\bf MSC 20}10 {\bf Subject Classification:}  Primary:  
%60J25, 92D10, 92D15, 92D25 92D40  
\\Secondary:   %60F05, 60G09, 60G55, 60G57, 60H15, 60J68
 
\end{abstract}
\tableofcontents
\newpage



%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}

\plr{I have not edited the introduction yet! It's just a pile of words. Skip to the next section.}

\todo[inline]{
From Terence: Personally, I think the long discussion on porous medium equations distract readers from the main message of our paper - we demonstrated a way to trace genealogy and derive dynamics of ancestral lineage through lookdown construction. I would suggest trimming most of the discussion there and only leaving discussions relevant to ancestries and lineages.}

There is now a huge literature devoted to spatial branching processes,
including branching random walk, 
branching Brownian motion, and the Dawson-Watanabe superprocesses.  
In addition to possessing a rich and beautiful mathematical structure, 
the superprocesses are remarkable for demonstrating a certain `universality', 
arising, as they do, as scaling limits of a vast array of different 
spatial population models \cite[e.g.,][]{chetwynd-diggle/etheridge:2018,
cox/perkins:2005,
cox/durrett/perkins:1999,
cox/durrett/perkins:2000,
holmes:2008,
vanderhofstad/sakai:2010,
vanderhofstad/slade:2003,
vanderhofstad/holmes/perkins:2017}.

These models make mathematical sense in very general spaces, but
in biological applications, typically, 
individuals are assumed to be scattered across one or two-dimensional
Euclidean space. In that setting, it is well known that, 
in the long term, the population will either 
die out, or it will develop clumps of arbitrary density and extent. 
To counter this, it is common to
impose some local regulation by either increasing death rates, or 
reducing birth rates, in proportion to the local population density,
so that the population has a tendency to grow in sparsely populated regions
and shrink where it is overcrowded. This leads to spatial analogues of  
logistic branching processes.

Although it can be more mathematically convenient to work with branching
Brownian motions, in many settings it is biologically more natural to 
develop models based on branching random walk.  
Individuals produce a random number of offspring,
that are thrown off according to some (usually symmetric) 
distribution centred on the location of the parent.   
This is particularly appropriate for modelling plant populations, in which
this dispersal of offspring around the parent is the only source of
spatial motion.


Most models do not distinguish between juveniles and adults, so,
for example, the number of adults produced by a single parent is determined
by the degree of crowding at the the location of the parent. The novelty
of the models that we introduce here is that, although we shall only
follow the adult population, in formulating the dynamics of the
models we shall distinguish
between production of juveniles, which will depend upon the location of 
the adult, and their successful establishment, which will depend on the
location in which a juvenile lands. The result is that not only the absolute 
number, but also the spatial distribution
around their parent, 
of those offspring that survive to adulthood
will depend upon the local population 
density. 


We shall consider different classes of scaling limits for our model; the first class consisting of
(generalised) super-processes limits, and the second class where the limits are deterministic. In the
superprocess setting, for our approach to work we measure the local population
density at a point by integrating against a smooth test function, for example 
a Gaussian density centred on that point.  
When the limit is deterministic,
we can simultaneously reduce the parameter in that Gaussian density so that,
in the limit, the local population density is simply the population density 
at that point. Nonetheless, we retain a signal of our two stage approach
to modelling reproduction, and  
in this way we recover a nonlinear partial differential equation. 
This approach requires some technical conditions that we will verify in two important examples,
the porous medium equation with a logistic growth term of the form 
$$\partial_t \varphi = \Delta (\varphi^2)+\varphi(1-\varphi),$$
and a wide class of semi-linear partial differential equations of the form 
$$\partial_t \varphi = \Delta\varphi+ \varphi \left(G(\varphi)-H(\varphi)\right),$$
which include the Fisher-KPP equation and the Allen-Cahn equation.

The porous medium equation (PME)
is a degenerate nonlinear diffusion equation that
has been the subject of intensive study. We refer to~\cite{vazquez:2007} for 
a comprehensive reference. The equation has also been studied with various
forms of noise, see~\cite{barbu/daprato/roeckner:2016}, although not the 
form of noise that will arise from the population dynamics below. 
Deriving nonlinear diffusion equations as limits of weakly interacting 
diffusions goes back at least to~\cite{mckean:1967}, and this 
programme has been
carried out for the PME and its generalisations. 
The degeneracy of the PME
results in some extra analytic
challenges,~\cite{jourdain:2000}.
Recent work in this 
direction has been spurred on by applications
in mathematical finance, %where the porous medium arises 
in particular, in the study of weak limits of systems
of diffusions interacting through their 
rank,~\cite{dembo/shkolnikov/varadhan/zeitouni:2016, jourdain/reygner:2013}
and references therein.
Our approach is different.
We start from individual
based population models, thus providing a microscopic mechanism that leads to 
nonlinear diffusion.
Other microscopic mechanisms have been proposed in the special case of the
PME, see 
e.g.~\cite{feng/iscoe/seppalainen:1997, oelschlaeger:1990}; ours
is specifically motivated by biological considerations.




Another novelty of our models stems from the use of lookdown construction to retain the dynamics of lines of descent in our population while passing to a scaling limit. The lookdown construction is first introduced in \cite{donnelly/kurtz:1996} to provide a mechanism to trace lineages while passing through a scaling limit for the Moran model. In more recent works, see~\cite{kurtz/rodrigues:2011, etheridge/kurtz:2018}, lookdown constructions are further applied into models of branching populations with spatial structures. In \S \ref{Sec: Lookdown Constructions}, we follow closely the techniques presented in these papers to impose lookdown constructions for our models which allow us to retain information about ancestry of individuals in the population as we pass to a large population limit. This in turn allows us to write down an explicit expression for the generator of the position of ancestral lineages with respect to the travelling wave fronts for populations modelled by a huge class of semi-linear partial differential equations, see Theorem \ref{teo:ancestral lineages}.
This attempt is novel and we have provided the first ever rigorous proof to similar results on ancestral lineages. This result allows us to compare ancestral lineages of individuals sampled from the front of a population evolving according to the PME with logistic growth to those under the Fisher-KPP and Allen-Cahn equations. For example, as a result of the nonlinear diffusion, 
for suitable initial conditions, the solution to the one-dimensional 
porous medium equation with logistic growth converges to a travelling
wave with a sharp cut-off; i.e., in contrast to the classical 
Fisher KPP equation, the solution at time $t$
vanishes beyond $x=x_0+ct$ for some constant wavespeed
$c>0$, \cite{kamin/rosenau:2004}.

\subsection{More motivation, on lineages, to merge with the above}

The history of a natural population is often only accessible indirectly 
through patterns of genetic diversity that have been laid down. From 
genetic data, one can try to infer the genealogical trees that relate 
individuals in a sample from the population. It is therefore of interest
to establish the distribution of genealogical trees relating individuals
sampled from a population evolving according to any proposed mathematical
model.

In general this is an extremely difficult question. However, in specical
circumstances, some progress can be made. One of the settings that
has received a great deal of attention in recent years is that in which 
a population is expanding into new territory as a travelling wave. 
Typically one considers a stationary wavefront moving across $\IR^1$, and
most work has focussed on the classical Fisher-KPP equation with a 
stochastic term, i.e.
$$dw=\big(\Delta w +sw(1-w)\Big)dt +\sqrt{\frac{\alpha(w)}{N}}W(dt,dx),$$
where $W$ is space-time white noise, and $N$ is a measure of the 
local population density. The coefficient
$\alpha(w)$ is generally taken to be either
$w$, corresponding to a superprocess limit, or $w(1-w)$ giving a 
spatial analogue of a Wright-Fisher diffusion. The first is 
appropriate for modelling the range of an expanding population,
the second for the spread of a selectively advantageous 
mutation through an established (selectively neutral) population. 
Because of the logistic control of the growth rate,
individuals in the wavefront can have much greater reproductive success
than those in the `bulk' of the expanding population. 
Tracing backwards in time, individuals sampled
from behind the wave are `caught' by the wave, upon which they become
trapped in the wavefront. If the population density is very high, then over
suitable timescales, the genealogical trees will be dominated by 
periods of extremely rapid coalescence corresponding to a significant 
proportion of the individuals in the front being descended from a particularly
reproductively successful ancestor. For a surprisingly wide range of models, 
it is believed that, for very large $N$ and on suitable timescales, 
genealogies converge to a 
Bolthausen-Sznitman coalescent, e.g.~\cite{brunet/derrida/mueller/munier:2007}. 
On the other hand, if one replaces the logistic growth term of the classical
Fisher-KPP equation with a nonlinearity that reflects cooperative
behaviour in the population, such as
$$wF(w)=w(1-w)(Cw-1),$$
then, for sufficiently large $C$ (strong cooperation),
the nature of the deterministic
wave changes from `pulled' to `pushed', \cite{birzu/hallatschek/korolev:2017}.
In that setting, the genealogies will also be quite different
from the Fisher-KPP case. For example, \cite{etheridge/penington:2020}
shows that for a discrete space model corresponding to this 
nonlinearity with $C>4$, after suitable scaling, the genealogy of a
sample converges not to a Bolthausen-Sznitman coalescent, but to
a Kingman coalescent. 
\todo[inline]{Is that condition $C>4$ correct? the paper with Sarah is done for the equation $\partial_t u = \Delta u + u(1-u)(2u-1+\alpha)$ and valid for $\alpha \in (0,1)$. Factorising we would get that equation would be $\partial_t u = \Delta u + (1-\alpha) u(1-u)(\frac{2}{1-\alpha}u-1)$. Supposing the $(1-\alpha)$ in front does not affect the result (which I suppose wouldn't) we get that $C= \frac{2}{1-\alpha}$ and so $\alpha \in (0,1)$ if and only if $C>2$ ...}
The reason, roughly, is that ancestral lineages
settle to a stationary distribution relative to the position of the 
wavefront which puts very little weight close to the `tip' of the wave, so
that when ancestral lineages meet,
it is typically in a location where population density is
high, where no single ancestor produces a disproportionately large number of 
descendants in a short space of time. 

As a first step towards understanding what we should expect in models with
nonlinear diffusion, we consider the position of an ancestral lineage
relative to the wavefront in the deterministic models, and compare that 
to what we see for a classical Fisher-KPP equation. 
In~\S\ref{sec: wright-malecot}, we then indicate how to extend these ideas to 
extract information about relatedness between two individuals in the 
superprocess limit, at least when population intensity is very high, and
we present some evidence to support the conjecture that genealogies 
for populations expanding according to 
our superprocess models with nonlinear diffusion
can be very different from those under 
the classical Fisher-KPP equation. 

% % % % % % % % % % % % % %
\subsection{Structure of the paper}

In the paper we study scaling limits of spatial popultaions,
obtaining convergence of both the population process
(i.e., the population density as a function of time,
although strictly speaking it is a measure that may not have a density)
as well as of lineages traced back through such a population.
We retain linages through the rescaling process
by means of a lookdown construction, which adds technical difficulty
to an already difficult topic.
Furthermore, convergence results for the lookdown process
require convergence of the population process.
So, we do not introduce the lookdown process until Section X.

First, in section X, we describe the model and the main theorems (Theorems X and Y).
Next, in section X, we discuss a few striking consequences of these results,
namely, X Y and Z.
In section X, we provide heuristic explanations
of why the theorems ought to be true,
and some key ideas behind them.
In Section X we define and discuss the lookdown process that retains the levels.
This is followed by the technical proofs in section X.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Notes to ourselves}

\plr{For recording/discussing notation decisions.}

$X$ is the original, unscaled process,
and $\eta(t) = X(t\theta)/N$.

When the process has a density, it is $\varphi(t, x) = d \eta_t(dx)/dx$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Model and main results}

The model we work with is a fairly general model
of individuals living in continuous space.
We shall suppose that we start with a population of
$\bigO(N)$ individuals per unit area distributed in $\mathbb{R}^d$.
For applications, $d=1$ or $d=2$, but our results apply more generally.
The population will be distributed over a bounded region,
so the total number of individuals will also be $\bigO(N)$.
We describe the state of the population at time $t$
with a counting measure $X(t)$,
which assigns one unit of mass to the location of each individual.
Locations need not be unique, so some locations may have a mass of greater than 1.

It will be simplest to think of the population as evolving in continuous time
and giving birth to one offspring at a time.
Population dynamics are controlled by three quantities,
birth, establishment, and death,
each of which can depend on spatial location and local population density.
Each individual gives birth at rate $\gamma$ to a single offspring,
and the offspring
then disperses according to a kernel $q(\cdot)$ away from the location of the parent.
We assume that $q$ is the density of a multivariate Gaussian,
allowing a nonzero mean and inhomogeneous variance.
The offspring does not necessarily survive to be counted in the population:
it ``establishes'' with probability $r$,
or else it dies immediately.
Independently, each individual dies with rate $\mu$.

We aim to obtain universal behavior by taking the density, $N$, to infinity,
and also scaling time by a factor of $\theta$,
so that defining $\eta(t) = X(\theta t) / N$,
the process $\{\eta(t)\}_{t \ge 0}$
will converge to a suitable measure-valued process
as $N$ and $\theta$ tend to infinity,
with the nature of the limit depending on how they tend to infinity together.
Demographic rates in our model
will be determined by local population density relative to $N$,
so that population dynamics depend more naturally on $\eta$ (rather than $X$).
However, to avoid confusion arising from the time scaling,
we describe the model in terms of $X$ next.
See Figure~\ref{fig:model_setup} for a conceptual depiction.

\begin{figure}
    \begin{center}
        FIGURE
    \end{center}
    \caption{
        Conceptual figure of the model.
        Left: (cartoon) plot of $\gamma$, $r$, $\mu$, and $F$ against density,
        showing the equilibrium point.
        Right: cartoon of interaction and dispersal distances.
        \label{fig:model_setup}
    }
\end{figure}

Birth, establishment, and death can depend on the location of the individual
and the local population density.
Since we would like the population density to scale with $N$,
these are functions of $X/N$, i.e.,
the counting measure with mass $1/N$ placed at the location of each individual.
To measure local population density, we convolve the population measure with
an ``interaction kernel'' -- for simplicity, we take these to be Gaussian
with various scales, and write
$$
    p_{\sigma^2}(x) = \frac{1}{(2 \pi \sigma^2)^{d/2}} e^{-\|x\|^2 / 2 \sigma^2} .
$$
Given a nonnegative function $\gamma(x, m) : \IR^d \times \IR_{\ge 0} \to \IR_{\ge 0}$,
the birth rate of an individual at location $x$ when the state of the population is $X$
is $\gamma(x, \smooth{\gamma} X(x) / N)$,
where $\smooth{\gamma} X$ is the convolution of $X$
with $p_{\epsilon_\gamma^2}$.
Similarly, the establishment probability of an offspring at location $x$ is
is $r(x, \smooth{r} X(x) / N)$,
where $r(x, m) : \IR^d \times \IR_{\ge 0} \to [0, 1]$
and again $\smooth{r} p_{\epsilon_r^2}$.
Rather than defining a function $\mu(x, m)$ for the death rate,
it turns out to be more convenient to parameterize in terms of the net reproductive rate,
which we denote by $F(x, m)$,
scaled by $1/\theta$
so that the population density changes over a time scale of $\theta$,
i.e., we have ``near-critical branching''.
Informally, we would like that
$$
    F = \theta (r \gamma - \mu) ,
$$
and to arrange this we define
the death rate of an individual at $x$ to be
\begin{align} \label{eqn:mu_defn}
    \mu
    =
    \max\left\{0, 
        r(x, \smooth{r} X(x) / N) \gamma(x, \smooth{\gamma} X(x) / N)
        - \frac{1}{\theta} F(x, \smooth{F} X(x) / N)
    \right\} ,
\end{align}
where again $F(x, m) : \IR^d \times \IR_{\ge 0} \to \IR_{\ge 0}$
and $\kernel_F = p_{\epsilon_F^2}$.

In summary, demographic parameters depend on local density measured
for birth over a scale of $\epsilon_\gamma$,
for establishment over a scale of $\epsilon_r$,
and for net reproductive rate over a scale of $\epsilon_F$.
Note that death rates depend in principle on population densities at three different scales,
so that we could write $\mu = \mu(x, \smooth{\gamma} X(x) / N, \smooth{r} X(x) / N, \smooth{F} X(x) / N)$.
It might seem like
we have introduced unnecessary complexity
with these three different spatial scales on which interactions occur.
However,
it will turn out to be useful in the proofs to have $\epsilon_r < \epsilon_\gamma$,
although in the limit they can be taken equal to each other,
so informally we think of local density as being determined on a scale of $\epsilon$.
The value of $\epsilon_F$ is unconstrained.

\begin{remark}
Although this model allows fairly general birth and death mechanisms,
there are a number of limitations.
Perhaps most obviously, to simplify the notation
individuals give birth to only one offspring at a time,
although this restriction could be easily lifted
\citep[as in][]{etheridge/kurtz:2018}.
Furthermore, individuals do not move during their lifetime,
and the age of an individual does not affect their fecundity or death rates.
Finally, there is no notion of mating,
so availability of mates will not restrict the spread of a population,
and the lineages we follow will be uniparental.
For these reasons, the model is most obviously applicable to bacterial populations,
although we do not anticipate that incorporation of these complications
will change the general picture.
\end{remark}

We next summarize the dynamics of the rescaled model $\eta(t) = X(\theta t)/N$,
and state some assumptions on the parameters.

\begin{definition}[Model parameterization and assumptions]
    \label{def:model_setup}
    For each $\theta \ge 0$,
    let $\left(\eta^\theta(t)\right)_{t \ge 0}$
    be the continuous-time measure-valued Markov process described above
    with birth rates, establishment probabilities, and death rates
    determined as follows.
    Suppose $\gamma(x, m)$, $r(x, m)$, and $F(x, m)$
    are bounded, uniformly continuous functions
    from $\IR^d \times \IR_{\ge 0}$ to $\IR_{\ge 0}$.
    Furthermore, suppose $r_\theta$ takes values in $[0, 1]$
    and has uniformly bounded second derivatives,
    and that $(x, m) \mapsto m^2 \gamma(x, m)$ is unformly bounded.
    Fix nonnegative values $\epsilon_r$, $\epsilon_\gamma$, and $\epsilon_F$,
    with $\epsilon_r < \epsilon_\gamma - 1/\theta$.
    Suppose $F: \IR^d \times \IR_{\ge 0} \to \IR$ is bounded and uniformly continous
    and define
    \begin{align}
        \mu(x, \eta)
        =
        r(x, \smooth{r} \eta(x))
        \gamma(\smooth{\gamma} \eta(x))
        - \frac{1}{\theta}
        F(x, \smooth{F} \eta(x)) .
    \end{align}
    Let $N$ be a positive number determined by $\theta$.
    When the state of the process is $\eta$,
    offspring of mass $1/N$ are produced at location $x$
    with rate $\theta \gamma(x, \smooth{\gamma} \eta(x)) N \eta(dx)$
    and adults die at location $x$ with rate $\theta \mu(x, \eta) N \eta(dx)$,
    (i.e., at rates $\theta \gamma$ and $\theta \mu$ per capita respectively).
    Offspring disperse to a location offset from the parent's location
    by an independent Gaussian with mean $\meanq/\theta$
    and covariance matrix $\covq / \theta$;
    an offspring at $x$ establishes instantaneously
    with probability $r(x, \smooth{r} \eta(x))$, or else dies.
\end{definition}

Since we are taking a diffusion limit,
we will have use for the following notation:

\begin{definition}[Dispersal generator]
    \label{def:dispersal_generator}
    Recall that we have defined the dispersal kernel,
    $q_\theta(x, dy)$,
    to be the density of a multivariate Normal
    with mean $\meanq/\theta$ and covariance matrix $\covq/\theta$.
    This implies that if we define, for $f : \IR^d \to \IR$,
    \begin{align}
    \DG f(x) = \sum_i \meanq_i \partial_{x_i} f(x)
        + \sum_{ij} \covq_{ij} \partial_{x_i} \partial_{x_j} f(x)
    \end{align}
    then
    \begin{align}
        \theta \int \left(
            f(y) - f(x)
        \right) q_\theta(x, dy)
    \to \DG f(x) 
        \qquad \text{as } \theta \to \infty .
    \end{align}
\end{definition}

\paragraph{Remark:}
An equivalent way to describe the model
would be to say that an individual at $x$ gives birth at rate
$$
    \gamma(x, \smooth{\gamma} \eta(x))
    \int r(x, \smooth{r} \eta(y)) q(x, dy) ,
$$
and that offspring disperse according to the kernel
$$
    q_\theta^\mathfrak{m}(x, dy)
    :=
    \frac{
        r(y, \smooth{r} \eta(y)) q_\theta(x, dy)
    }{
        \int r(x, \smooth{r} \eta(z)) q_\theta(x, dz)
    } .
$$
Clearly, the random walk driven by this dispersal kernel
should be biased towards regions of higher establishment probability.
For comparison to future results,
it is interesting to write down the limiting generator:
\begin{align*}
    \lim_{\theta \to \infty}
    \theta \int (f(y) - f(x)) q_\theta^\mathfrak{m}(x, dy)
    &=
    \frac{
        \DG\left[ f(\cdot) r(\cdot, \smooth{r} \eta(\cdot)) \right](x)
        - 
        f(\cdot) \DG\left[ r(\cdot, \smooth{r} \eta(\cdot)) \right](x)
    }{
        r(x, \smooth{r} \eta(x))
    } .
\end{align*}
In the simplest case of unbiased, isotropic dispersal,
$\meanq = 0$ and $\covq = I$, so $\DG = \Delta$,
and this is equal to
\begin{align*}
    \Delta f(x) + 2 \grad f(x) \cdot \grad \log r(\cdot, \smooth{r} \eta(\cdot))(x) .
\end{align*}
However, we will see that following a lineage back through the population
has a different behavior yet again.


% % % % % % % % % % % % % % %
\subsection{Main results on population processes}

\comment{
Set-up: there are two dichotomies:
is the limiting process deterministic or a generalized superprocess?
See Figure \ref{fig:super_vs_det_2d} for simulations.
And, are interactions local in the limit or not?
Below we have results for three of these cases;
as for the remaining one (local, superprocess),
it should be possible in 1D, not in higher dimensions (brief note).
}


\begin{figure}
    \begin{center}
        FIGURE
    \end{center}
    \caption{
        TODO: Figure depicting deterministic vs superprocess dichotomy:
        showing 2D images of populations,
        one with $\theta/N$ not small, the other with $\theta/N$ small.
        \label{fig:super_vs_det_2d}
    }
\end{figure}

\begin{theorem} \label{thm:nonlocal_convergence}
    Let $(\eta^\theta_t)_{t \geq 0}$
    be as defined in Definition \ref{def:model_setup}
    and assume that as $\theta \to \infty$, $N \to \infty$
    in such a way that $\theta/N \to \delta$.
    (However, interaction distances $\epsilon_r$, $\epsilon_\gamma$, and $\epsilon_F$
    remain constant.)

    The sequence of stochastic processes
    $(\eta^\theta_t)_{t \geq 0}$
    converges along subsequences in distribution as $\theta \to \infty$
    to a measure-valued process $(\eta_t)_{t \geq 0}$
    which satisfies that, for every $f:\mathbb{R}^d \rightarrow \mathbb{R}$,
    \begin{align} \label{eqn:mgale_problem}
        M_t
        &:=
        \langle f(x), \eta_t(dx) \rangle
        -
        \langle f(x), \eta_0(dx) \rangle
        \\ & \qquad
        -
        \int_0^t \big\langle
            \gamma(x, \smooth{\gamma} \eta_s(x))
            \mathcal{B}\left(
                f(\cdot) r(\cdot, \smooth{r} \eta_s(\cdot))
            \right)(x)
            +
            f(x)
            F(x, \smooth{F} \eta_s(x)),
            \eta_s(dx)
        \big\rangle ds,
    \end{align}
    is a martingale.
    The quadratic variation of $M_t$ is given by 
    \begin{align} \label{eqn:mgale_variation}
        [ M ]_t
        =
        \delta
        \int_0^t
        \big\langle
            \gamma\left( x, \smooth{\gamma} \eta_s(x) \right)
            r\left(x, \smooth{r} \eta_s(x) \right)
            f^2(x),
            \eta_s (dx)
        \big\rangle ds. 
    \end{align}
    In other words, the limit is a measure-valued process with non-local interactions.
    Furthermore, if $\delta = 0$ the limit is deterministic.
\end{theorem}

Theorem \ref{thm:nonlocal_convergence} provided convergence along subsequences;
i.e., for any sequence of values of $\theta$
there is a subsequence that converges.
However, if the limiting process is unique then the convergence is unqualified.
In the deterministic case, we have convergence to a nonlocal PDE.
\comment{Maybe the following two corollaries should be combined?}

\comment{
    \textbf{Question:}
    In our outline
    we said this corollary would be about uniqueness,
    but is it also about continuity of the limit (i.e., existence of a density)?
    A lot of my uncertainty in how to phrase these results
    comes from being unsure what exactly we can say about densities.
}

\begin{corollary}[Deterministic limits]
    \label{cor:nonlocal_pde_limits}
    In the context of Theorem~\ref{thm:nonlocal_convergence},
    if the limit is deterministic (i.e., $\theta / N \to \delta = 0$), $\eta_0$ has a density,
    and \comment{additional conditions? can we say something like this??}
    then any limit $\eta_t(dx)$ has a density $\varphi(t, x)$,
    which is a weak solution to the nonlocal partial differential equation
    \begin{equation} \label{eqn:nonlocal_pde}
        \partial_t \varphi(t, x)
        =
        r\left(x, \smooth{r} \varphi(t,x) \right)
        \mathcal{B} \left[
            \varphi(t, \cdot)
            \gamma\big( x, \smooth{\gamma} \varphi(t, \cdot) \big)
        \right](x)
        +
        \varphi(t, x)
        F\left(x, \smooth{F} \varphi(t,x) \right)
        .
    \end{equation}
    If equation \eqref{eqn:nonlocal_pde} has a unique solution,
    then $(\eta^\theta_t)_{t \ge 0}$ converges to that solution.

    In particular, if
    \comment{TODO: find some conditions under which this is true?}
    then we have convergence to a unique solution.
\end{corollary}

Informally, equation \eqref{eqn:nonlocal_pde} is the PDE
\begin{align} \label{eqn:pde}
    \dot \varphi = r \DG\left( \gamma \varphi \right) + \varphi F ,
\end{align}
where $\DG$ is an elliptic second order differential operator,
and the coefficients $r$, $\gamma$, and $F$
at $x$ depend nonlocally on $\varphi$
(i.e., through a smoothed version of $\varphi$).

\begin{corollary}[Superprocess limits] \label{cor:superprocess_uniqueness}
    In the context of Theorem~\ref{thm:nonlocal_convergence},
    if the martingale problem
    defined by equations \eqref{eqn:mgale_problem} and \eqref{eqn:mgale_variation}
    has a unique solution,
    then $(\eta^\theta(t))_{t \ge 0}$ converges to that solution
    as $\theta \to \infty$.
    \comment{
        Is this what we want to say here? Could be said better.
        TODO: see what Dawson \& Li say about uniqueness
        so we have at least some conditions under which this happens.
    }
\end{corollary}

Theorem~\ref{thm:nonlocal_convergence} shows convergence to the solution to a nonlocal PDE
of the form \eqref{eqn:nonlocal_pde}.
Since the coefficients at $x$ in \eqref{eqn:nonlocal_pde}
depend only on the region nearby to $x$,
we would often expect solutions of the nonlocal PDE to be close to the corresponding local PDE
as the interaction distances $\epsilon_r$, $\epsilon_\gamma$ and $\epsilon_F$
go to zero.
The following propositions give two concrete situations in which that is true.

\comment{I've not got straight exactly how we're framing this
    (namely, does $\eta$ have a density?).
    Also, is this one or two propositions --
    we said initially this would be two,
    one for FKPP and one for PME,
    but then maybe the argument was more general?
}

\begin{proposition}
    \label{prop:nonlocal_to_local}
    Suppose that $\eta_\epsilon(t,dx)$ is a solution to equation \eqref{eqn:nonlocal_pde}
    with $r(x, m) = 1$ for all $x$ and $m$
    and some $\epsilon_r < \epsilon_\gamma = \epsilon_F = \epsilon$
    \comment{and assumptions on $\gamma$? and $F$?}.
    Then $\eta_\epsilon(t, dx)$ converges \comment{in what sense?} as $\epsilon \to 0$
    to $u(t, x) dx$, which solves
    \begin{align} \label{eqn:PDE}
        \partial_t u(t, x)
        =
        \DG \left( \gamma(\cdot, u(t, \cdot) u(t, \cdot)  \right)(x)
        + F(x, u(t, x)) u(t, x) .
    \end{align}
\end{proposition}

Theorem \ref{thm:nonlocal_convergence} combined with Proposition \ref{prop:nonlocal_to_local}
imply that we can take the $\theta \to \infty$ limit
followed by $\epsilon \to 0$
to obtain solutions to the PDE \eqref{eqn:PDE}.
However, it is of substantial interest to know whether
we can take those two limit simultaneously.
The general case seems difficult,
but we can prove such ``diagonal'' convergence in the following situation.

\begin{theorem}[Convergence to a PDE]
    \label{thm:local_convergence}
    Let $(\eta^\theta_t)_{t \geq 0}$
    be as defined in Definition \ref{def:model_setup}
    and assume that as $\theta \to \infty$, $N \to \infty$
    and $\epsilon_r < \epsilon_\gamma = \epsilon_F = \epsilon \to 0$
    in such a way that $\theta/N \to 0$
    and
    \comment{TODO: some conditions on $\epsilon$ and $r$ and $\gamma$ and $F$}.
    Then the sequence of stochastic processes $(\eta^\theta_t)_{t \ge 0}$
    converges \comment{in some sense}
    to a measure-valued process with a density $\varphi(t, x)$
    that solves
    \begin{align}
        \partial_t \varphi(t, x)
        &=
        \text{whatever the final form is here} .
    \end{align}
\end{theorem}


% % % % % % % % % % % %
\subsection{Main results on lineages}

Now that we have established what we can say about how population density changes with time,
we turn to results on ancestral lineages,
i.e., how genealogical ancestry moves across the landscape.
Informally,
a \emph{lineage} $(L_t)_{t \ge 0}$
begun at spatial location $L_0 = x$
can be obtained by picking a focal individual uniformly at $x$,
and then for each amount of time $t$ in the past,
setting $L_t$ to the spatial location of the individual from whom
the focal individual inherits.
Since in our model individuals have only one parent, this is unambiguous.
Although we did not explicitly retain such information,
it is clear that
for finite $\theta$ (and hence, finite $N$),
one could construct the distribution of a lineage $(L_t)_{t=0}^T$
given the history of the population $(\eta^\theta_t)_{t = 0}^T$,
for each starting location to which $\eta^\theta_T$ assigns positive mass.
It is less clear, however, how to formally retain such information in the limit.
The \emph{lookdown construction} in Section~\ref{sec:lookdown}
provides just such a construction,
where lineages are retained in the $N \to \infty$ limit.
Roughly speaking,
this works by assigning to each particle a unique ``level''
that functions as a label and thus allows reconstruction of lineages,
but also (in some sense) orders individuals by eventual reproductive output,
allowing a formal limit.
See~\ref{etheridge/kurtz:2018} for an introduction to these ideas.

A lineage is, in general, a well-defined stochastic process,
but there are two important questions
that affect its tractability.
First, when is it a Markov process given the population process?
(I.e., given $(\eta_t)_{t=0^T}$ that records numbers of individuals
but not their ancestry.)
We expect the answer here to be that a lineage is Markov
only in the $N \to \infty$ limit.
\comment{(or, do we know this? we can cite Barton, Depaulis and Etheridge at least for discussion.)}
Second, does the process have a tractable description?
If the population process has a density,
then it turns out that a lineage is a diffusion driven by the density.
The remaining case is the superprocess limit ($\theta/N \to \delta > 0$);
in this case, we expect that a lineage could still be described as a generalized diffusion,
but moving within a stochastic landscape that is singular in $d \ge 2$.
We focus on the more tractable situation where the population process is deterministic.
However, the results here apply to either the local or nonlocal case
(i.e., where the density solves a local or nonlocal PDE).

\comment{
    \textbf{Note:} the previous write-up motivated things only in the time-stationary case
    (so, a stationary traveling wave, possibly with wave speed zero;
    see the corollary below).
    It'd be very nice to give this more general result,
    but the proof has to be checked to make sure it still applies,
    and the notation is time-inhomogeneous and so more annoying
}


\begin{definition}[Generator of a lineage] \label{def:lineage_generator}
    Let $(\varphi(x, t))_{0 \le t \le T}$
    denote the density of a population that solves \eqref{eqn:nonlocal_pde},
    and let $y$ be a point with $\varphi(y, T) > 0$.
    We define $(L_s(y))_{s=0}^T$,
    the ancestral lineage of an individual sampled at $y$ at time $T$,
    to be the position of the unique ancestor of $y$ alive at time $T - s$.
    We define
    $(Q_s)_{s \geq 0}$
    to be the time inhomogeneous semi-group satisfying
    \begin{align*}
        Q_s f(y) := \IE_y[ f(L_s) ] ,
    \end{align*}
    and $\Lgen_s$ to be the generator of this semi-group.
\end{definition}

Our main result identifies a lineage as a diffusion
by characterizing its generator.
To avoid complexity,
we do this in the case where dispersal is $N(\meanq/\theta, \sigma^2 I/\theta)$,
in which case $\DG = \sigma^2 \Delta + \meanq \cdot \grad$.

\comment{
    Allowing a more general dispersal mechanism won't just entail replacing $\Delta$ with $\DG$,
    it will also change at least one of the $\grad$s to something else (I think).
}

\begin{theorem} \label{thm:lineages}
    In the context of Definition~\ref{def:lineage_generator},
    if the dispersal process is isotropic (i.e., $\covq = \sigma^2 I$),
    then
    \begin{equation}
        \label{eqn:lineage_generator}
        \Lgen_s f
        =
        \sigma^2 r \gamma
        \left(
            \Delta f
            +
            \left(
                2 \grad \log(\gamma \varphi)
                - \meanq
            \right)
            \cdot \grad f
        \right) .
    \end{equation}
    In other words, 
    a lineage behaves as a diffusion
    that is driven by a Brownian motion 
    run at speed $\sigma^2$ multiplied by the local per-capita production of offspring ($r \gamma$)
    in a potential equal to the local birth output tilted by migraiton bias
    ($\varphi \gamma \exp(-\meanq \cdot x / 2 \sigma^2)$).
\end{theorem}

To make the generator readable, we've written it in concise notation,
omitting the dependencies on location and population density,
which itself changes with time.
When interpreting this,
remember that everything depends on location and density at that location and time --
for instance, ``$r$'' is actually $r(x, \varphi(T-s, x))$.

\comment{This corollary was the previous theorem in the previous draft.
    Besides this proposed set-up, we have the additional options of
    (a) renaming the corollary a theorem and only proving it,
    or (b) presenting only the corollary here (as a theorem)
    and presenting the more general theorem later on.
}

\begin{corollary} \label{cor:wavefront}
    In addition to the assumptions of Theorem~\ref{thm:lineages},
    suppose that the population process is described by a traveling wave with speed $\wavespeed$,
    i.e., the population has density
    $\varphi(t, x) = w(x - t \wavespeed)$
    where $w$ solves
    \begin{align*}
        r \Delta (\gamma w) + w F(w) + \wavespeed \cdot \grad w = 0 .
    \end{align*}
    Then the generator $\Lgen$
    of the motion of a linages in this population is
    \begin{align}
        \Lgen f
        &=
        r \gamma
        \left(
            \Delta f
            +
            2 \grad \log (\gamma w)
            \cdot \grad f
        \right)
        + \wavespeed \cdot \grad f .
    \end{align}
\end{corollary}


%%%%%%%%%%%%%%%%%%%%%%
\section{Examples and applications}

Next,
we cover some illustrative examples
and interesting applications.

% % % % % % % % % % % %
\subsection{A nonlinear diffusive population: the Porous Medium Equation}

\comment{
    This section:
    model set-up including the limit;
    comparison of the simulation profile to deterministic solution.
    See Figure \ref{fig:pme_waves}.
}

Consider the porous medium equation (PME) with logistic growth,
\begin{equation}
    \label{eqn:pme}
    \partial_t v = \partial_x^2 (v^2) + v (1 - v) ,
\end{equation}
an example of a reaction-diffusion equation with a nonlinear diffusion term.
Such equations are widely used in a number of contexts in biology in which
it is clear that motility within a population varies with population density.
For example, density dependent dispersal is a common feature in spatial
models in ecology, eukaryotic cell biology, and avascular tumour growth;
see e.g.~\cite{sherratt:2010} and references therein for further discussion. 
We shall pay particular attention to the case in which the equation can be 
thought of as modelling the density of an expanding population. 
The specific equation that we use to illustrate the implications of
our results is one of a class used to study pattern formation in 
bacterial colonies. In particular, it has been suggested as a model for
the expansion of bacteria of the type {\em Paenbacillus dendritiformis} on
a thin layer of agar in a petri dish, 
\cite{cohen/golding/kozlovsky/benjacob/ron:1999}. 

Comparing \eqref{eqn:pme} to \eqref{eqn:pde},
we see that to set up a limit in which the population density $\varphi$ follows the PME,
we need $r=1$,
$\gamma = \varphi$, and $F = 1 - \varphi$.
Consulting equation~\eqref{eqn:mu_defn},
we then need death rate to be $\mu = (1 + 1/\theta) \varphi - 1/\varphi$.
In other words,
establishment is certain
and birth rates to increase linearly with population density,
but to compensate, death rates increase slightly faster (also linearly),
as shown in Figure~\ref{fig:pme_waves}.
Alert readers will notice that this violates our boundedness assumptions;
\comment{(perhaps this is too much detail here)}
in practice we choose a suitably small value for $\beta$ and define
\begin{align*}
    \gamma(x, m) &= (1 - \exp(- \beta m)) / \beta \\
    F(x, m) &= \exp(- \beta m) / \beta ,
\end{align*}
which in turn implies that death rate when local density is $m$
is roughly $(1 + 1/\theta) (1 - \exp(-\beta m)) / \beta - 1/(\theta \beta)$.
Birth and death rates are equal at density $m = 1$,
corresponding to an unscaled density of $N$ individuals per unit area.

\begin{figure}
    \begin{center}
        FIGURE
    \end{center}
    \caption{
        Two panels, showing simulated 1D populations under the PME, comparing the simulated
        profile to the analytical solution;
        $\theta/N$ not small on left; small on right.
        (Note: noisier wave should move slower, we'll see this.)
        \label{fig:pme_waves}
    }
\end{figure}

This equation has an explicit travelling wave solution
\begin{align} \label{eqn:pme_wave}
    w^P(t, x)
    :=
    \left( 1 - e^{ \frac{1}{2} (x - x_0 - t) } \right)_+ .
\end{align}
Notice that the wave profile has a sharp boundary at $x = x_0 + t$.
There are also travelling wave solutions with $c>1$ \citep{gilding/kersner:2005},
which lack this property.
However, for initial conditions that decay sufficiently rapidly at infinity,
such as one might use in modelling a population invading new territory,
the solution converges to \eqref{eqn:pme_wave} \citep{kamin/rosenau:2004}.

Indeed, simulations of this process
shown in Figure~\ref{fig:pme_waves}
display traveling wave solutions
similar to numerical solutions of the PME,
with increasingly good agreement for larger $\theta$ and $N$.
As expected, noise slows down the wave.


% % % % % % % % % % % %
\subsection{Traveling waves}

\begin{figure}
    \begin{center}
        FIGURE
    \end{center}
    \caption{
        Six panels: one pair for FKPP, one for PME, and one for Allen-Cahn.
        Each pair shows (top) lineage traced back in wavefront,
        and (bottom) stationary distribution of lineage location,
        compared to analytical solution for PME.
        \label{fig:pme_vs_fkpp}
    }
\end{figure}

\comment{
    This section:
    explain generator in stationary frame;
    derive stationary distribution;
    introduce FKPP;
    compute for PME and FKPP.
    (Also: Allen-Cahn example?)
    The two cases are very different, as shown in Figure \ref{fig:pme_vs_fkpp}.
}

It is interesting to investigate the motion of an ancestral lineage
in special cases in which we have an explicit expression for the travelling
wave profile $w$. 

%%%%%%%%%%
\paragraph{Porous Media:}
Setting $x_0=0$ (for definiteness) and substituting
the form of $w^P$ from equation \eqref{eqn:pme_wave}
into Corollary~\ref{cor:wavefront},
with $c=1$,
$\gamma(x, m) = m$,
$r(x,w) = 1$,
and $F(x, m) = (1 - m)$,
the lineage's generator is, for $x < 0$,
\comment{(need to decide whether to use $f_x$ or $\delta_x f$)}
\begin{align*}
    \Lgen f
    &=
        w(x)
        \left(
         f_{xx}
         +
         2 \frac{(w^2)_x}{w^2} f_x
        \right)
        + f_x \\
    &=
        \left(1 - e^{\frac{1}{2} x} \right)
        f_{xx}
        -
        2 e^{\frac{1}{2} x} f_x
        +
        f_x .
\end{align*}
The speed measure corresponding to this diffusion is,
again for $x < 0$,
\begin{align*}
    m(d\xi)
    &\propto
        \frac{ 1 }{ 2 (1 - \exp{\xi/2}) }
        \exp\left(
            \int_\eta^\xi \left\{
                1 - \frac{e^{x/2}}{1 - e^{x/2}}
            \right\} dx
        \right) \\
    &\propto
        e^\xi\left(1-e^{\xi/2}\right),
        \quad
        \text{for } \xi < 0 ,
\end{align*}
which is integrable and so when suitably normalised gives the unique stationary distribution.
Notice that at stationarity
the lineage will typically be significantly behind the front. 

%%%%%%%%%%
\paragraph{Fisher--KPP:}
A great deal more attention has been paid to the classical Fisher-KPP equation,
\begin{align} \label{eqn:fkpp}
    v_t = v_{xx} + v (1-v) .
\end{align}
In this case,
even though we do not have an explicit formula for the wave shape,
these methods give us information about ancestral lineages.
The equation has non-negative travelling wave solutions of speed $c$ for all $c \geq 2$, 
but started from any compact perturbation of a Heaviside function, the 
solution will converge to the profile $w^F$ with the minimal wavespeed, $c=2$,
\cite{kolmogorov/petrovsky/piscounov:1937,bramson:1983}.
No matter what the initial condition,
for any $t>0$ the support of the 
solution will be the whole real line. 
Since in ths case, $r = \gamma = 1$,
the generator of the motion of an ancestral lineage is
$$
    \Lgen \phi
    =
    \phi_{xx} + 2 \frac{w_x}{w} \phi_x + 2 \phi_x .
$$
Near the tip of the wave (for $x$ large), $w^F(x) \sim e^{-x}$,
so the motion of the lineage is close to Brownian motion.
On the other hand, for $x < 0$ the lineage behaves approximately as
Brownian motion with drift at rate two to the right.
This implies that
ancestral lineages are pushed into the tip of the wave,
and there is no stationary distribution.
These results agree with those of \comment{XXX}.


%%%%%%%%%%
\paragraph{Allen-Cahn:}
Finally, we take the Allen-Cahn equation
\begin{align} \label{eqn:allen_cahn}
    v_t = v_{xx} + v(1-v)(2v-1+s),
\end{align}
for a given $s \in (0,2)$,
which is used to model populations evolving under selection \cite{Sarah}.
This equation also has an explicit travelling wave solution
of shape
\[ w^A(x) = (1+e^{x})^{-1}. \]
The generator for ancestral lineages is, in this case,
\begin{align*}
    \hat{\mathcal{L}}\phi
    &=
    \phi_{xx}
    + 
    2 \frac{w_x}{w} \phi_x
    +
    s \nabla \phi \\
    \qquad &=
    \phi_{xx}
    -
    2 \frac{e^x}{1+e^x} \phi_x 
    + 
    s \nabla \phi,
\end{align*}
so lineages in the tip are pushed into the bulk of the wave by the drift $-2(e^{-x}+1)^{-1}$,
but that drift gets weaker further to the left.
This diffusion has speed measure
$$
    m(d\xi) \propto e^{sx}(1+e^x)^{-2},
$$
which is concentrated around $\log(s/(2-s))$ and decays like $e^{x(s-2)}$ away from this point.
These results agree with those of \cite{etheridge/penington:2020}.


% % % % % % % % % % % % % % % %
\subsection{Clumping from nonlocal interactions}

\comment{
    Description of the process;
    discussion of when it happens;
    (TODO: how's it affected by $\theta$?)
}

\begin{figure}
    \begin{center}
        FIGURE
    \end{center}
    \caption{
        Two panels: left is 2D picture of clumped population;
        right is a bumpy expanding wavefront.
        \label{fig:clumping}
    }
\end{figure}

% % % % % % % % % % % % % % % %
\subsection{Populations with Varying Lineage Distributions but Same Stationary Profile}

Consider two populations with coefficients $r_1, \gamma_1, \mu_1$ and  $r_2, \gamma_2, \mu_2$, and denote their lineage motion generator and profile as $\hat{\mathcal{L}}_1,w_1$, and $\hat{\mathcal{L}}_2,w_2$. We further assume that our populations have a stationary distribution with $\Xi_t(x)=w(x)$, i.e. $\mathfrak{c}=0$.\\
Let $\beta(x)>0$ and take $r_2(x)=r_1(x)\beta(x),~ \mu_2(x)=\mu_1(x)\beta(x),~ \gamma_2(x)=\gamma_1(x)$. Since $F=r\gamma-\mu$, we have that 
\begin{multline}
\label{eq: same profile scaled}
r_2\Delta(\gamma_2 w_2)+(r_2\gamma_2-\mu_2)(w_2)=0\implies r_1\beta \Delta(\gamma_1 w_2)+(r_1\beta \gamma_1-\mu_1 \beta)(w_2)=0\\
\implies r_1 \Delta(\gamma_1 w_2)+(r_1 \gamma_1-\mu_1)(w_2)=0 \implies w_2=w_1.
\end{multline}
The two populations share the same stationary profile but their ancestral lineage motions are different as 
\begin{equation}
\label{eq: different generator scaled}
\hat{\mathcal{L}}_2 \phi = r_1 \beta \gamma_1\left(\Delta\phi+2\frac{\nabla(\gamma_1 w_1)}{\gamma_1 w_1}\nabla\phi\right)\neq r_1 \gamma_1\left(\Delta\phi+2\frac{\nabla(\gamma_1 w_1)}{\gamma_1 w_1}\nabla\phi\right) = \hat{\mathcal{L}}_1 \phi.
\end{equation}
The stationary distribution of our population is unchanged when we scale $r,\mu$ by a rate of $\beta(x)$,
but the motion of lineages is sped up locally by $\beta$.
This corresponds to making areas with $\beta > 1$ more ``sink-like'',
because there death rate is higher, but also is the establishment of new individuals. Those regions as a result have lower long-term fitness and lineages spend less time there.


%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Heuristics}
    \label{sec:heuristics}

% % % % % % % % % % % % % % % % % %
\subsection{Population processes}
    \label{sec:population_heuristics}

\comment{TODO: short lead-in}

We write $\Pgen^\theta$
for the generator of the scaled population process $\eta$ acting
on test functions of the form 
$$
    F( \langle f, \eta\rangle )
    =
    F \left( \int f(x)\eta(dx) \right),
$$
where $f \geq 0$ is smooth and compactly supported on $\IR^d$ and 
$F \in C^\infty ([0,\infty))$.
Recall that $N \to \infty$ along with $\theta$,
although we don't remind the reader with extra superscripts.


A Taylor expansion allows us to write
\begin{multline*}
    \Pgen^\theta
    F(\langle f,\eta \rangle)
    =
    F'(\langle f, \eta \rangle)
    \lim_{\delta t\downarrow 0} \frac{1}{\delta t}
    \IE\left[
        \left. \langle f, \eta_{\delta t} \rangle
        -
        \langle f, \eta \rangle
        \right| \eta_0=\eta
    \right]
    \\
    \qquad {}
    + \frac{1}{2}
        F''(\langle f,\eta\rangle)
    \lim_{\delta t\downarrow 0}\frac{1}{\delta t}
    \IE\left[
        \left.\big(\langle f,\eta_{\delta t}\rangle
        -
        \langle f, \eta\rangle\big)^2 \right|\eta_0=\eta
    \right]
    +
    \varepsilon_{\theta}(f, F, \eta),
\end{multline*}
where the terms that make up 
$\varepsilon_{\theta, N}(f, F, \eta)$
will be negligible in our scaling limit. 

\subsubsection*{Mean measure}

Consider first the mean measure. For a suitable 
(smooth, compactly supported) test function $f$, we find
\begin{multline}
\label{mean measure}
{\cal L}^{(\theta, N)}\langle f,\eta\rangle=
\lim_{\delta t\downarrow 0}\frac{1}{\delta t}
\IE\left[\left.\langle f,\eta_{\delta t}\rangle -
\langle f, \eta\rangle \right|\eta_0=\eta
\right]\\
=\theta\int\int f(z)r_\theta(z,\eta)q_\theta(x,dz)
\gamma_\theta(x,\eta)
\eta(dx)-\theta\int f(x)\mu_\theta(x,\eta)
\eta(dx).
\end{multline}
The first term is the increment in $\langle f,\eta\rangle$
resulting from a birth event (recalling that
we don't kill the parent) integrated against the rate of such events,
and the second reflects death events.
In both terms, the 
rate of events has a factor of $N$ (because events happen at a rate 
proportional to the number of individuals, whereas $\eta$ is
the scaled population mass) which is offset by the fact that  
the birth or loss of a single 
individual at the point $y$, say, changes $\langle f,\eta\rangle$
by $f(y)/N$.

We use the fact that $\int q_\theta(x,dz)=1$ to rewrite~(\ref{mean measure})
as 
\begin{multline}
\label{rewritten mean measure}
\int\left(\int \theta \left(
f(z)r_\theta(z,\eta)- f(x)r_\theta(x,\eta)\right)
q_\theta(x,dz)\right)
\gamma_\theta(x,\eta)
\eta(dx)
\\
+\int\theta\int f(x)\Big(r_\theta(x,\eta)
\gamma_\theta(x,\eta)
-\mu_\theta(x,\eta)\Big)
\eta(dx).
\end{multline}
Suppose that $\eta\to\Xi$, a measure on $\IR^d$,
in the scaling limit, then we see that we can 
let $\theta\rightarrow\infty$ in~(\ref{rewritten mean measure})
under the assumptions that
\begin{eqnarray}
r_\theta(x,\eta)&\stackrel{\theta\to\infty}{\longrightarrow}&
r(x,\Xi)\\
\gamma_\theta(x,\eta)&\stackrel{\theta\to\infty}{\longrightarrow}&
\gamma(x,\Xi)\\
\int\theta \Big(r(z,\eta)f(z)-
r(x,\eta)f(x)\Big)q_\theta(x,dz) 
&\stackrel{\theta\to\infty}{\longrightarrow}& 
\Delta \big(r(\cdot,\Xi)f(\cdot)\big)(x);\\
\theta \Big(r_\theta(x,\eta)\gamma_\theta (x,\eta)
-\mu_\theta (x,\eta)\Big)
 &\stackrel{\theta\to\infty}{\longrightarrow}& 
F(x,\Xi),
\label{near critical}
\end{eqnarray}
where $\Delta$ denotes the Laplacian.
The last condition reflects the `near-critical' branching. Note that
there is a slight mismatch between the locations at which we are 
measuring birth and death rates, because in~(\ref{near critical})
the establishment probability is 
measured at $x$ rather than at the point where juveniles fall. 
This condition also differs from the assumption that
we use in~\S\ref{scalings with levels} to guarantee convergence of the 
processes with levels in our lookdown 
constructions, see~(\ref{lookdown blambda}). 
Under mild
regularity conditions on $r$ (which we certainly need to have sensible 
limiting models) the conditions are equivalent.  

Equation~(\ref{rewritten mean measure}) converges to
\begin{equation}%\begin{multline}
\label{limit of mean measure equation}
\int \gamma(x,\Xi)
\Delta
\big(f(\cdot)r(\cdot,\Xi)\big)(x)
\Xi(dx)
+\int f(x)
F(x,\Xi)
\Xi(dx)
.
\end{equation}

\subsubsection*{Quadratic variation}

We now look at the second order term.
We spell out
this calculation in detail so that it is evident at which points we are 
exploiting the choice of the Poisson distribution for the number
of juvenile offspring.
In the general case one can expect somewhat messier calculations, but
the same conclusion (up to constants).

When an individual at the point $x$ gives birth, the total number of
mature offspring is Poisson with parameter
$$\gamma_\theta(x,\eta)\int 
r_{\theta}(y,\eta) q_{\theta}(x, dy)
=\gamma_\theta(x,\eta)p_\theta(x,\eta).$$
Offspring that survive to maturity are distributed about the parent
according to 
$$\overline{q}_\theta(x,\eta,dy):=
\frac{r_{\theta}(y,\eta)q_\theta(x,dy)} 
{\int r_{\theta}(z,\eta)q_\theta(x,dz)}. 
$$
Writing $X(x)$ for the increment to $\langle f, \eta\rangle$
due to a single mature offspring of an individual at $x$, 
and $P(x)$ for the (Poisson) number of mature
offspring in such an event, the variance of the increment to 
$\langle f, \eta\rangle$
resulting from a birth event at $x$ is $\IE[P(x)]\mathtt{var}(X(x))
+\mathtt{var}(P(x))\IE[X(x)]^2=\IE[P]\IE[X(x)^2]$. 
Since, in this notation, conditional on the value of $\eta$
immediately before the event,
$$\IE[X(x)^2]=\int
\frac{1}{N^2}f^2(y) \overline{q}_\theta(x,\eta,dy),$$
and
$$\IE[P(x)]=
\gamma_\theta (x,\eta) \int 
r_{\theta}(z,\eta)q_\theta(x,dz),$$ 
the contribution to the quadratic variation from birth events, which
occur at rate $\theta$ per individual 
(so $N\theta |\eta|$ overall), is
$$\langle N\theta \gamma_\theta(x,\eta)
\int \frac{1}{N^2}f^2(y)r_{\theta}(y,\eta)
q_\theta(x,dy) 
,\eta(dx)\rangle.$$
The increment in $\langle f, \eta\rangle$ resulting from 
the death of an individual at $x$ is $f(x)/N^2$, and so combining with the 
above, the second order term in the generator takes the form
$$F''(\langle f,\eta\rangle)
\frac{1}{2}N\theta \left\{
\langle \gamma_\theta(x,\eta)
\int \frac{1}{N^2}f^2(y)r_\theta(y,\eta)q_\theta(x,dy) 
,\eta(dx)\rangle
+\langle \mu_\theta(x,\eta)\frac{1}{N^2}f^2(x) 
,\eta(dx)\rangle\right\}.
$$
The term $\varepsilon_{\theta,N}(f, F, \eta)$ will be 
${\mathcal O}(\theta/N^2)$.

\subsubsection*{Limit I: deterministic case}

By choosing $\theta/N\rightarrow 0$, the second order term in the generator 
will vanish and we expect a deterministic limit. 
Let us suppose that the limit has a smooth density with respect to
Lebesgue measure, and abuse notation by using $\Xi_t(x)$
to denote the corresponding density, then integrating the first term in~(\ref{limit of mean measure equation})
by parts, we find that in the limit as $N\to\infty$,
\begin{equation}
\nonumber
\frac{d}{dt}\int f(x)\Xi_t(x)dx
=\int f(x)\left\{r(x,\Xi_t)\Delta\big(\gamma(\cdot,\Xi_t)
\Xi_t(\cdot)\big)(x)+F(x,\Xi_t)
\Xi_t(x)
\right\}dx.
\end{equation}
In other words, we can expect the limit to be a weak solution to the 
deterministic equation
\begin{equation}
\label{deterministic limit}
\frac{d\Xi}{dt}
=r(x,\Xi)\Delta\big(\gamma(\cdot,\Xi)
\Xi(\cdot)\big)(x)+F(x,\Xi)
\Xi(x).
\end{equation}


\subsubsection*{Limit II: stochastic case}

If $N=\rho\theta$, for some constant $\rho$,
the second order term in the generator remains order
one as $\theta\to\infty$, and  
we expect a `generalised
superprocess'
limit. Assuming some regularity of the coefficients (in particular 
of $r$), 
the second order term in the generator will  
take the form
$$\frac{1}{\rho}F''(\langle f,\Xi\rangle)
\langle f^2(x), \gamma(x,\Xi)
r(x,\Xi)\Xi(dx)\rangle.
$$
That is
$$\langle f(x), \Xi_t(dx)\rangle-\langle f(x), \Xi_0(dx)\rangle
-\int_0^t\langle\gamma(x,\Xi_s)\Delta\big(r(\cdot,\Xi_s)f(\cdot)\big)(x),
\Xi_s(dx)\rangle ds$$
is a martingale with quadratic variation
$$\frac{2}{\rho}\int_0^t\langle f^2(x) 
\gamma(x,\Xi_s)r(x,\Xi_s),\Xi_s(dx)\rangle ds.$$




\plr{TODO: heuristics of conditions to get a local (PDE) limit?}


% % % % % % % % % % % % % % % % % %
\subsection{Lineages}

\plr{
    TODO: Heuristics for how lineages should move given the population process.
}


%%%%%%%%%%%%%%%%%%%
\section{The lookdown process}
    \label{sec:lookdown}

\plr{Motivation for and definition of the lookdown process; statement of main convergence theorem.}

Now we
will present a lookdown construction for $(\overline{\eta}^{\epsilon,\theta,N}(t))_{t \geq 0}$ stated in Definition \ref{Def: Rescaled Models}
in the spirit of~\cite{kurtz/rodrigues:2011}. 
The key benefit of working in such a framework is that
we shall be able to preserve the notion of individuals, and in particular their genealogies, when we pass to the limit. Our notation will follow a standard pattern.

% % % % % % % % % % % % % % % %
\subsection*{Prelimit Models and Notation}\label{Prelimit Models and Notation Section}

In the prelimiting models each individual in the population will be assigned a 
`level' from $[0,\lambda]$. We also let $\lambda$ takes on the role of $N$ in \S \ref{sec: model and results}, i.e. each individual has mass $1/\lambda$ in the scaling limit. Speed is once again scaled by $\theta$ and local radius by $\varepsilon(\theta)$.\\
A state of the discrete population model will be of the form $\eta=\sum\delta_{(x,u)}$, where $x$ denotes the  
spatial location of an individual, and $u$ is its level. Just as we did in \S\ref{prelimiting spatial model}, we shall
abuse notation and treat $\eta$ both as a set and as a counting
measure. The population of \S\ref{prelimiting spatial model}
is recovered as $\overline{\eta}=\frac{1}{\lambda}\sum_{(x,u)\in\eta}\delta_x$, i.e. $\overline{\eta}$ is the spatial projection of our spatial-level model $\eta$. 
Conditional on $\overline{\eta}$, the levels of individuals in 
the population will be independent, uniformly distributed random variables
on $[0,\lambda]$. All of this can be found in \cite{etheridge/kurtz:2018},\cite{kurtz/rodrigues:2011}.
Test functions for this enriched process take the form
\begin{equation}
\label{test functions}
f(\eta)=\prod_{(x,u)\in\eta}g(x,u)=\exp\left(\int\log g(x,u)\eta(dx, du)\right),
\end{equation}
where $g(x,u)$ is differentiable in $u$ and 
smooth in $x$. Moreover, $0\leq g(x,u) \leq 1$ for all $u\in [0,\lambda]$, and 
$g(x,u)\equiv 1$ for $u\geq \lambda$.

In the expressions that follow, we shall often see one or more factor of
$1/g(x,u)$; 
it should be understood that if $g(x,u)=0$, then it simply cancels 
the corresponding factor in $f(\eta)$.

% % % % % % % % % % % % % % % %
\subsection*{Generator of the Scaled Lookdown Model}

In the notation of \S\ref{heuristics}, we now write down the 
generator of the scaled population model with levels where 
$\lambda$ is the scaling factor of the mass of an individual, $\theta(\lambda)$ is the scaling factor for time and the level of an individual particle must be in $[0,\lambda]$.  
Recall that we only track the adult population; maturity, if achieved, is 
instantaneous. Furthermore, at rate $\theta\gamma_{\theta}(x, \overline{\eta})$ a parent gives birth to a single juvenile offspring.

We should consider an initial population of $O(\lambda)$ many particles with levels uniformly distributed between $[0, \lambda]$. We write $(\eta^{\theta, \lambda}(t))_{t \geq 0}$ for our population at the $\theta$th stage of rescaling. To recover the scaling of \S\ref{sec: model and results} we scale the empirical distribution of particles alive with a factor of $1/\lambda$, so we write $$\overline{\eta}^{\theta, \lambda}(t)=\frac{1}{\lambda}\sum\limits_{\substack{(X(t),U(t))\in \eta \\ U(t) < \lambda}} \delta_{X(t)}.$$ 
From here onwards we write $\eta$ to be the particle systems with levels while $\overline{\eta}$ is the normalised empirical distribution. An individual of the population with state $\eta$ living at spatial location $x$ produces
one adult offspring at rate $\theta\gamma^{\mathfrak{m}}_{\theta}(x, \overline{\eta})$, where
$$\gamma^{\mathfrak{m}}_{\theta}(x,\overline{\eta})=\gamma_\theta(x,\overline{\eta})
\int r_\theta (y, \overline{\eta})q_\theta(x,dy).
$$
The location of this offspring is given by
the distribution 
\[ q^{\mathfrak{m}}_\theta(x,\overline{\eta},dy) = \frac{r(y,\overline{\eta}) q_{\theta}(x,dy)}{\int_{\mathbb{R}^d} r(y,\overline{\eta}) q_{\theta}(x,dy)}. \] In the lookdown version of our model, the individual $(x,u)\in\eta^{\theta, \lambda}$ gives
birth to an offspring at rate 
$2(\lambda-u)\lambda^{-1}\theta \gamma^{\mathfrak{m}}_{\theta}(x, \overline{\eta})$. 
(Averaging
over the distribution of the
level $u$ we recover $\theta \gamma^{\mathfrak{m}}_{\theta}(x, \overline{\eta})$.)

A new level $u_1$ is sampled independently and
uniformly from $[u,\lambda]$, and the parent and the offspring 
are assigned in random order to the  levels $\{u, u_1\}$. This random assignment of levels to child and offspring ensures that conditional on $\overline{\eta}$, the levels assigned to individuals are i.i.d. uniform random variables. Otherwise, the levels of the initial population would be lower than those of the descendants.\\
Evidently this mechanism increases the proportion of individuals with
higher levels. To restore the property that,
conditional
on $\overline{\eta}$, the intensity of
levels is conditionally uniform, we impose that 
the level associated with
$(x,u)\in\eta$ evolves
according to the differential equation
$$\dot{v}= \theta \gamma^{\mathfrak{m}}_{\theta}(x, \overline{\eta}) 
\left\{\lambda^{-1}(\lambda -v)^{2}
-(\lambda -v)\right\}.$$

See~\cite{etheridge/kurtz:2018}, Section~3.4 for a detailed explanation.
In order to incorporate death, the level of the individual $(x,u)\in \eta$ 
moves upwards at an additional 
rate $\theta \mu_\theta(x,\overline{\eta})$ (on reaching level $\lambda$ an
individual is deemed to
have died). Overall, we assume that the level associated with $(x,u)\in\eta$
evolves according to
$$\dot{u}= \theta \gamma^{\mathfrak{m}}_{\theta}(x, \overline{\eta}) 
\left\{\lambda^{-1}(\lambda -u)^{2}
-(\lambda -u)\right\}+\theta \mu_\theta(x,\overline{\eta})u.$$
We shall write 
$$b_{\theta, \lambda}(x,\overline{\eta}):=\theta\big\{\gamma^{\mathfrak{m}}_{\theta}(x,\overline{\eta})
-\mu_\theta(x,\overline{\eta})\big\}.$$
Note that this quantity captures the deviation from criticality in the branching
mechanism. In this notation, the differential equation governing the level of the
individual $(x,u)\in\eta$ is
\begin{align}
\dot{u}&=\lambda \theta \gamma^{\mathfrak{m}}_{\theta}(x,\overline{\eta}) 
\left\{\left(1-\frac{u}{\lambda}\right)^{2}
-1 +2\frac{u}{\lambda}\right\} -b_{\theta, \lambda}(x,\overline{\eta})u \nonumber \\
&=\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\theta}(x,\overline{\eta}) u^2 -b_{\theta, \lambda}(x,\overline{\eta})u. \label{differential equation for level}
\end{align}
In this setting, the generator of our model acting on the test functions $f(\eta)=\prod_{(x,u) \in \eta}g(x,u)$ satisfies
%We assume that  locations in ${\mathbb{ R}}^d$.
\begin{eqnarray}\label{Generator of prelimit simplest model}
&&A_{\theta, \lambda}f(\eta ) \nonumber \\
&&\quad =f(\eta )\,\sum_{(x,u)\in\eta}\,2\lambda^{-1}\theta \gamma^{\mathfrak{m}}_{\theta}(x, \overline{\eta})
\int_u^{
\lambda}\Bigg(\frac 12\frac {\int_{\mathbb{R}^d}g(y,u)q^{\mathfrak{m}}_\theta(x,\overline{\eta },d
y)g(x,v_1)}{g(x,u)} \label{multgen3}\\
&&\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad
+\frac 12\int_{\mathbb{R}^d}g(y,v_1)q^{\mathfrak{m}}_\theta(x,\overline{\eta} ,dy)-
1\Bigg)dv_1\nonumber\\
&&\quad \quad +f(\eta )\left(\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\theta}(x,\overline{\eta}) u^2 -b_{\theta, \lambda}(x,\overline{\eta})u\right)\frac {\partial_u g(x,u)}{g(x,u)}\nonumber\\
&&\quad =f(\eta )\,\sum_{(x,u)\in\eta}\,2 \gamma^{\mathfrak{m}}_{\theta}(x, \overline{\eta})\lambda^{-1}\int_u^{
\lambda}\Bigg(\frac 12\frac {\theta\int_{\mathbb{R}^d}(g(y,u)-g(x,u))q^{\mathfrak{m}}_\theta(x,\bar{
\eta },dy)g(x,v_1)}{g(x,u)}\non\\
&&\qquad\qquad\qquad\qquad\qquad\qquad\qquad +\theta\int_{\mathbb{R}^d}\left(\frac{g(y,v_1)+g(x,v_1)}{2}-1\right)q^{\mathfrak{m}}_\theta(x,\overline{\eta },dy)\Bigg)dv_1\nonumber\\
&&\qquad\qquad
+f(\eta )\sum_{(x,u)\in\eta}\,\left(\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\theta}(x,\overline{\eta}) u^2 -b_{\theta, \lambda}(x,\overline{\eta})u\right)\frac {\partial_u g(x,u)}{g(x,u)}.\nonumber
\end{eqnarray}
The two terms under the integral
correspond, respectively, to the parent being assigned 
a level other than $u$, and being reallocated to the level $u$ during a
birth event. In the first case, the parent at location $x$, which had level $u$ before the 
event, moves to level $v_1$, and the child is inserted at level $u$ and location $y$; in 
the second the parent retains its level, and offspring is inserted at
level $v_1$.\\~\\




As in Definition \ref{Def: Rescaled Models}, the rates $\gamma_{\theta},r_\theta, \mu_{\theta}$ in our re-scaled lookdown models  depend on the local density of $\eta$ through a mollification with $\varrho_{\varepsilon}$. We will now make our re-scaled lookdown model explicit.

\begin{definition}\label{Def: Rescaled Lookdown Models}
Let the coefficients $\tilde{\gamma}, \tilde{\mu}, \tilde{r}$ satisfy the conditions highlighted in Definition \ref{Def: Rescaled Models} and let $\varrho_{\varepsilon}$ be the kernel defined in Definition \ref{Defn: Kernel and Convolution}. We define the following terms:
\begin{align*}
\gamma^{\mathfrak{m}}_{\varepsilon,\theta}(x, \overline{\eta}):=&~\tilde{\gamma}_{\theta}(x, \varrho_{\varepsilon}*\overline{\eta}(x)) \int \tilde{r}_{\theta}(y, \varrho_{\varepsilon}*\overline{\eta}(y))q_{\theta}(x,dy),\\
 q^{\mathfrak{m}}_{\varepsilon, \theta}(x,\overline{\eta},dy) :=&~ \frac{\tilde{r}_{\theta}(y,\varrho_{\epsilon}*\overline{\eta}(y)) q_{\theta}(x,dy)}{\int_{\mathbb{R}^d} \tilde{r}_{\theta}(y,\varrho_{\epsilon}*\overline{\eta}(y)) q_{\theta}(x,dy)},\\
b_{\varepsilon, \theta, \lambda}(x, \overline{\eta}):=&~ \theta \bigg\{ \tilde{\gamma}_{\theta}(x, \varrho_{\varepsilon}*\overline{\eta}(x)) \int \tilde{r}_{\theta}(y, \varrho_{\varepsilon}*\overline{\eta}(y))q_{\theta}(x,dy)-\tilde{\mu}_{\theta}(x, \varrho_{\varepsilon}*\overline{\eta}(x)) \bigg\}
\end{align*}
At the $\lambda$-stage of re-scaling, our test measures $\eta$ takes value in $\mathcal{M}_F(\mathbb{R}^d \times [0,\lambda])$, the set of finite measures on $\mathbb{R}^d \times [0,\lambda]$, and we define $$\overline{\eta}= \frac{1}{\lambda}\sum_{(x,u) \in \eta}\delta_x.$$
We define $(\eta^{\varepsilon, \theta, \lambda}_t)_{t \geq 0}$ to be the (unique?) solution to the Martingale Problem with initial condition $\eta_0$ and generator $A_{\varepsilon, \theta, \lambda}$ that satisfies
\begin{eqnarray}\label{Eq: Prelimit Lookdown Generator}
&&A_{\epsilon, \theta, \lambda}f(\eta ) \\
&&\quad =f(\eta )\,\sum_{(x,u)\in\eta}\,2 \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(x, \overline{\eta})\Bigg\{ \frac 12 \lambda^{-1}\int_u^{
\lambda}g(x,v_1)dv_1\times \frac { \theta\int_{\mathbb{R}^d}(g(y,u)-g(x,u))q^{\mathfrak{m}}_{\varepsilon,\theta}(x,\bar{
\eta },dy)}{g(x,u)}\non\\
&&\qquad\qquad\qquad\qquad\qquad\qquad\qquad +\lambda^{-1}\theta\int_u^{
\lambda}\int_{\mathbb{R}^d}\left(\frac{g(y,v_1)+g(x,v_1)}{2}-1\right)q^{\mathfrak{m}}_{\varepsilon,\theta}(x,\overline{\eta },dy)dv_1\nonumber\Bigg\}\\
&&\qquad\qquad
+f(\eta )\sum_{(x,u)\in\eta}\,\left(\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(x,\overline{\eta}) u^2 -b_{\varepsilon,\theta, \lambda}(x,\overline{\eta})u\right)\frac {\partial_u g(x,u)}{g(x,u)}.\nonumber
\end{eqnarray}
for all smooth functions $f \in C(\mathbb{R}^d)$. 
\end{definition}
In \S \ref{sec: Markov Mapping Theorem application}, through an application of the Markov Mapping Theorem, we will show that the spatial projection of $(\eta^{\varepsilon, \theta, \lambda}_t)_{t \geq 0}$ has the same distribution as $(\overline{\eta}^{\varepsilon, \theta, N}_t)_{t \geq 0}$ if we take $\lambda = N$. Specifically, we mean that when $\lambda=N$, 
$$(\overline{\eta}^{\varepsilon,\theta, \lambda}(t))_{t \geq 0}:=\left(\frac{1}{\lambda}\sum\limits_{\substack{(X(t),U(t))\in \eta^{\varepsilon,\theta, \lambda}(t) \\ U(t) < \lambda}} \delta_{X(t)}\right)_{t \geq 0}$$
has the same distribution (as stochastic processes) as $(\overline{\eta}^{\varepsilon,\theta, N}_t)_{t \geq 0}$ in Definition \ref{Def: Rescaled Models}. As a result, we use the same notation $\overline{\eta}$ to denote these two essentially identical processes which take values in the space of empirical measures. On the other hand, we reserve the notation $\eta$ strictly for the spatial-level process.\\~\\ Furthermore, the application of Markov Mapping Theorem implies that particle levels are, conditional on $\overline{\eta}$, i.i.d and uniformly distributed between $[0, \lambda]$.  Theorem A.10 in \cite{kurtz/rodrigues:2011} states that convergence of $(\eta^{\varepsilon, \theta, \lambda}_t)_{t \geq 0}$ to a conditionally Poisson system $(\xi_t)_{t \geq 0}$ with Cox measure $\Xi_t \times \Lambda$ is equivalent to convergence of $(\overline{\eta}^{\varepsilon, \theta, N}_t)_{t \geq 0}$ to $(\Xi_t)_{t \geq 0}$. As a result, it suffices for us to focus on tightness of $(\eta^{\varepsilon, \theta, \lambda}_t)_{t \geq 0}$ and spatial convergence of $(\overline{\eta}^{\varepsilon, \theta, N}_t)_{t \geq 0}$ as $\theta \to \infty$.




%% %% %% %% %% %% %% %% %% %% %% %%
\subsection{Evolution of an Individual Particle}
\label{sec: Evolution of an Individual Particle}

Here we give a general framework of tracking evolution of individual particles in the population described above. We will provide the right scaling of the coefficients introduced in \S \ref{sec: Convergence of Spatial-Level Models}.\\
Particles alive at time zero will be indexed by
$(0, i)$, or more precisely, we index the levels of the particles alive at time $0$ by $(0, i)$ keeping
in mind that at each birth event, the parent particle will, with probability $1/2$ change levels.
Since no two particles born after time $0$ will be born at the same time, we index the rest of
the levels by their birth times. With each level, we can associate a Poisson random measure
$\xi$ on $[0, \infty)^2\times [0,1]\times \{0,1\}$ (eventually, $\lambda \to \infty$) with mean measure $l^3 \times \{\frac{1}{2}\delta_0,\frac{1}{2}\delta_1\}$ which
determines the birth times of the offspring of the particle at that level, the location of the
offspring, and whether the offspring or the parent is placed at the new level. Let $U_{\tau}(t)$ be
the level at time $t \geq \tau$ if the level first appeared at time $\tau$ , and let $X_{\tau}(t), t \geq \tau$ be the
location of the particle with level $U_{\tau}(t)$. 
Now $U_{\tau}$ satisfies
\begin{equation}
U_{\tau}(t)=U_{\tau}(\tau)+\int_{\tau}^{t}(\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(s),\overline{\eta}(s))U^2_{\tau}(s)-b_{\varepsilon,\theta,\lambda}(X_{\tau}(s),\overline{\eta}(s))U_{\tau}(s))ds, ~~~ t \geq \tau.    
\end{equation}
If a level has index $\tau$ and $(s,v,w,\kappa)\in \xi_\tau$, then $\tau+s$ gives a potential birth time for an offspring of the particle at level $U_{\tau}$. We say `potential' since if $U_{\tau}(\tau+s)>\lambda$, the corresponding particle is dead. The (potential) new level is 
\begin{equation}\label{New birth potential level}
    U_{\tau+s}(\tau+s)=U_{\tau}(\tau+s)+ \frac{v}{2\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s-))}.
\end{equation}
If $U_{\tau+s}(\tau+s)< \lambda$, a new particle is produced with location $X_{\tau}(\tau+s-)+H(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s-),w)$ where $H(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s-),w)$ is a function such that if $w$ is a uniformly distribution on $[0,1]$, then 
\begin{equation}\label{eq: Individual Evolution Jump Kernel}
P(H(x, \overline{\eta},w)\in C | \overline{\eta},x)=q^{\mathfrak{m}}(x, \overline{\eta},C).    
\end{equation}
Consequently, 
$$X_{\tau}(\tau+s)=X_{\tau}(\tau+s-)+\kappa H(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s),w)$$
and 
$$X_{\tau+s}(\tau+s)=X_{\tau}(\tau+s-)+(1-\kappa) H(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s),w),$$
that is if $\kappa=0$, the parent stays at its current level and the new particle is given the new
level. If $\kappa = 1 $, the parent is given the new level and the new particle is given the original
level. Consequently, for $t \geq \tau$
\begin{align}\label{eq: Spatial evolution of individual lineage}
X_{\tau}(\tau+t)=&X_{\tau}(t)\\
&+\int_{(0,t]\times[0,\infty]\times[0,1]\times\{0,1\}}\mathbbm{1}_{U_{\tau}(\tau+s)+ \frac{v}{2\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s-))}<\lambda\}}\kappa    H(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s),\omega) \\
&\qquad \times \xi_{\tau}(ds,dv,dw,d\kappa).
\end{align}
Starting with an initial particle at level $U_{(0,i)}$ , we can identify a potential line of descent by
taking $(s_1 , v_1 , w_1 , \kappa_1 ) \in \xi_{(0,i)}$ , setting $\tau_1=s_1$ , and then recursively taking $(s_k , v_k , w_k , \kappa_k ) \in \xi_{\tau_k }$ and defining $\tau_{k+1} = \tau_{k} + s_{k+1}$. Each time $\tau$ at which a new level appears has an “ancestory” of this type.\\
We now explain the cases where $\kappa_k=0$ and $\kappa_k=1$. When $\kappa_k=0$, the parent retains the level, so $X_{\tau_{k}}$ remains the same at time $\tau_{k+1}$. When $\kappa_k=1$, the offspring gets its parent's level while the parent inherits a new level sampled between $[U_{\tau_k}(\tau_{k+1}-),\lambda]$. As a result, the spatial location $X_{\tau_{k}}$ jumps from the parent's location to the offspring's location at time $\tau_{k+1}$.  Meanwhile, between $[\tau_k, \tau_{k+1}]$ there maybe further birth events generated by $\xi_{\tau_k}$. If $(s,v,w,\kappa) \in \xi_{\tau_k}$, Equation \eqref{eq: Spatial evolution of individual lineage} holds and gives the spatial evolution of $X_{\tau_k}$ for $t \in [\tau_k, \tau_{k+1}]$.\\

For $\tau=\tau_m$ in a recursion like this, let
\begin{equation}\label{eq: Individual Evolution Recursion Terms}
\zeta^{0}_{\tau}(B)=\sum_{k=1}^{m}\delta_{(s_k,v_k,w_k,(1-\kappa_k))}, ~~~ V_{\tau}(t)=\sum_{k=1}^{m}v_k\mathbbm{1}_{[0, \tau_k]}  (t)  
\end{equation}
and define $U_{\tau}(0)=U_{(0,i)}, X_{\tau}(0)=X_{(0,i)}(0)$, and $\zeta_{\tau}$ by
\begin{equation}\label{eq: integrand in spatial tracing}
\zeta_{\tau}(B)=\zeta_{\tau}^{0}(B)+\sum_{k=0}^{m}\int \mathbbm{1}_{B}(\tau_k+s,v,w,\kappa)\mathbbm{1}_{\{\tau_k+s<\tau_{k+1}\}}\xi_{\tau_k}(ds,dv,dw,d\kappa)    
\end{equation}

where $\tau_{m+1}=\infty$. Then 

\begin{align*}
U_{\tau}(t)=&U_{\tau}(0)+\int_{0}^{t}\frac{1}{2\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(s-), \overline{\eta}(s-))}dV_{\tau}(s)\\
&+\int_{0}^{t}\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(s-), \overline{\eta}(s-))U^2_{\tau}(s)-b_{\varepsilon,\theta, \lambda}(X_{\tau}(s),\overline{\eta}(s))U_{\tau}(s))ds,\\  
X_{\tau}(t)=&X_{\tau}(0)+\int_{(0,t]\times[0,\infty]\times[0,1]\times\{0,1\}}\mathbbm{1}_{U_{\tau}(\tau+s)+ \frac{v}{2\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s-))}<\lambda\}}\\
&\qquad \times \kappa   H(X_{\tau}(s-), \overline{\eta}(s-),\omega)\zeta_{\tau}(ds,dv,dw,d\kappa)
\end{align*}
gives the spatial and level dynamics of a lineage. Note that $\zeta^{0}_{\tau}(B)$ produces spatial jumps when $\kappa_k=1$, while the integral against $\xi_{\tau_k}$ in Equation \eqref{eq: integrand in spatial tracing} gives spatial jumps when $(s,v,w,\kappa) \in \xi_{\kappa_k}$, $\tau_k \leq s \leq \tau_{k+1}$, and $\kappa = 1$. This corresponds to the discussion given above.
\begin{remark}
The factor $\frac{1}{2\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(x, \overline{\eta})}$ that scales the jump in levels give an average birth rate of $\theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(s-), \overline{\eta}(s-))$. This is because for the potential birth to be a true birth, we impose that $$U_{\tau}(\tau+s)+ \frac{v}{2\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s-))}< \lambda,$$ where $U_{\tau}(\tau+s)$ is uniformly distributed between $[0, \lambda]$. As a result, a true birth occurs between $[0,\delta t]$ if there exists $(s,v) \in [0,\delta t]\times [0, 2 (\lambda-U_{\tau}(\tau+s)) \lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s-))]$. Averaging this over levels give a Poisson process with rate $ \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(\tau+s-), \overline{\eta}(\tau+s-))$. 
\end{remark}
\begin{remark}
Although the labelling presented here depends on random birth times, we can label each individual in the population deterministically with the Ulam-Harris label. We therefore have a countable particle system. In particular, we can now express our particle systems as
$$\eta(t)=\frac{1}{\lambda}\sum_{U_{\tau}(t) < \lambda} \delta_{X_{\tau}(t),U_{\tau}(t)}, ~~\overline{\eta}(t)=\frac{1}{\lambda}\sum_{ U_{\tau}(t) < \lambda} \delta_{X_{\tau}(t)}.$$
For further discussion refer to \S \ref{sec: Ulam-Harris Labels characterisation}.
\end{remark}


%% %% %% %% %% %% %% %% %% %% %% %%
\subsection{Stochastic equations for movement of lines of descent}
    \label{sec:lines_of_descent}

    \plr{This section needs to follow from the previous section better (and maybe be merged with it).}

The main interest in using a lookdown construction for our 
population processes is that it allows us to retain information 
about relatedness between individuals as we pass to the infinite
density limit. In order to exploit this, we generalise the construction of 
stochastic equations presented in \S \ref{sec: Evolution of an Individual Particle} to the infinite density limit.\\
In the scaling limit $A^{\text{nl}}_{\varepsilon}$, the spatial movement of particles can be characterised with the map $$h \mapsto \gamma\big(x,(\varrho_{\varepsilon}*\Xi)(x)\big)r\big(x,(\varrho_{\varepsilon}*\Xi)(x)\big)\mathcal{B}^{m}_{\varepsilon}(\Xi)h(x) ,$$
and as individual particles travel as a random walk in the pre-limit model, we should expect a diffusion limit for individual trajectories.
\todo[inline]{From Terence: we should try explain in detail why this is the generator of an individual line of descent forward-in-time. The main question here is whether we should have a factor of $r$ in the above notation. For the proof to work in \S \ref{sec: motion of ancestral lineages} we will need a factor of $r$ but I have been finding it slightly unintuitive particularly since the effect of $r$ has been accounted into $\mathcal{B}^{\mathfrak{m}}$ through the limit.}
To simply notation, we let the above map be the generator of a process 
satisfying 
\[X(t)=X(0)+\int_0^t\sigma (X(s),\Xi (s))dW(s)+\int\beta (X(s),\Xi 
(s))ds.\]
\begin{remark}
In particular recall that as in Remark \ref{Remark: Product Rule on Laplacian}, if $\mathcal{B}$ is the Laplacian operator, then the generator above is merely 
$$\gamma\big(x,(\varrho_{\varepsilon}*\Xi)(x)\big)\left(\Delta h(x) +2 \nabla h(x) \cdot \nabla \log r( \cdot, (\varrho_{\varepsilon}*\Xi)(\cdot))(x)\right),$$
and applying Ito's formula we have 
\begin{equation}\label{eq: Individual lineage generator description}
\begin{aligned}
\beta(X(s),\Xi(s))=& 2\gamma\big(X(s),(\varrho_{\varepsilon}*\Xi)(X(s))\big) \nabla \log r (\cdot, (\varrho_{\varepsilon}*\Xi)(\cdot))(X(s))\\
\sigma(X(s),\Xi(s))=& \sqrt{2\gamma\big(X(s),(\varrho_{\varepsilon}*\Xi)(X(s))\big)}.
\end{aligned}
\end{equation}
\end{remark}
Furthermore, recall that in our scaling limit, 
\begin{equation}
\begin{aligned}
\lambda^{-1} \theta \gamma^{\mathfrak{m}}_{\varepsilon,\theta}(X_{\tau}(s), \overline{\eta}(s)) &\to \ell \gamma(X_{\tau}(s),\varrho_\varepsilon*\Xi(X_{\tau}(s)),\\
b_{\varepsilon,\theta, \lambda}(X_{\tau}(s),\overline{\eta}(s)) &\to  F(X_{\tau}(s), (\varrho_{\varepsilon}*\overline{\eta})(X_{\tau}(s)))\\
&+\gamma(X_{\tau}(s), (\varrho_{\varepsilon}*\Xi)(X_{\tau}(s)))\mathcal{B}r(\cdot,(\varrho_{\varepsilon}*\overline{\eta})(\cdot))(X_{\tau}(s)).
\end{aligned}    
\end{equation}

We now have the required results to establish the individual lineage dynamics in the scaling limit. Our approach should be compared to Perkins stochastic calculus,
\cite{perkins:1995}. First we label the individuals alive at time $0$
by $\{(0,i), i\in\IN\}$. 

When an individual is born, it is endowed with an
independent Poisson random measure $\xi$ on $[0,\infty)^2$ with Lebesgue
mean measure. The first coordinate encodes {\em potential} birth times of 
offspring of the individual. We say potential, since the parent may have
died before the potential birth time. 
Since, after time $0$, no two particles will have the same birth
time, we index the particles born after time $0$ by 
their birth times.  
For example, if a parent has index $\tau$ and $(s,v)\in \xi_\tau$, then 
$\tau +s$ gives a potential birth time for an offspring which, if
it is in fact born, will carry
the label $\tau+s$. 
The second 
coordinate of $\xi$ will be used to determine, after scaling, 
the level of offspring relative to the 
level of the parent (offspring are always born to levels above that of
the parent). 

Starting with an initial particle 
$(0,i)$, we can identify a potential line of descent by 
taking $(s_1,u_1)\in\xi_{(0,i)}$, setting $\tau_1=s_1$, and then recursively 
taking $(s_{k+1},u_{k+1})\in\xi_{\tau_k}$ and defining $\tau_{k+1}
=\tau_k+s_{k+1}$.

With each particle, we will 
associate an independent Brownian motion, $W_\tau$. For times 
$t>\tau$, the spatial location and level of the particle with
label $\tau$ are then determined by
\begin{equation}\label{Eq: Expression for dynamics in scaling limit}
\begin{aligned}
X_{\tau}(t)=&X_{\mbox{\rm $\tau$}}(\tau )+\int_{\tau}^t\sigma (X_{
\tau}(s),\Xi (s))dW_{\tau}(s)+\int_{\tau}^t\beta (X_{\tau}(s),\Xi (
s))ds\\
U_{\tau}(t)=&U_{\tau}(\tau )+\int_{\tau}^t\bigg\{\ell \gamma(X_{\tau}(s),\varrho_\varepsilon*\Xi(X_{\tau}(s)U_{\tau}^2(s) \\
& -\big(F(X_{\tau}(s), (\varrho_{\varepsilon}*\overline{\eta})(X_{\tau}(s)))+\gamma(X_{\tau}(s), (\varrho_{\varepsilon}*\Xi)(X_{\tau}(s)))\mathcal{B}r(\cdot,(\varrho_{\varepsilon}*\overline{\eta})(\cdot))(X_{\tau}(s))\big)U_{\tau}(s))\bigg\}ds.
\end{aligned}
\end{equation}
If $(X_{\tau'},U_{\tau'})$ is the parent of $(X_{\tau},U_{\tau})$, 
then there is $(s,v)\in\xi_{\tau'}$ 
such that $\tau =\tau'+s$,
$X_{\tau}(\tau'+s)=X_{\tau'}(\tau'+s)$ and 
\begin{equation}
\label{Eq: expression for offspring level in limit}
U_{\tau}(\tau )=U_{\tau}(\tau'+s)=U_{\tau'}(\tau'+s)+\frac v{2\ell \gamma(X_{\tau}(s),\varrho_\varepsilon*\Xi(X_{\tau}(s))U_{\tau}^2(s)},
\end{equation} 
recognizing 
that $U_{\tau'}(\tau'+s)$ may be infinite, which means 
that $(X_{\tau}, U_{\tau})$ doesn't exist.
To see why we scale $v$ in this way, 
we observe that
in order for $U_{\tau}(\tau'+s)$ to be below some fixed level $u_g$,
we require 
$v<2\ell \gamma(X_{\tau'}(\tau'+s),\varrho_\varepsilon*\Xi(X_{\tau'}(\tau'+s))U_{\tau}^2(\tau'+s)\big(u_g-U_{\tau'}(\tau'+s)\big)$.
Recalling
that $\xi_{\tau'}$ is Poisson on $[0,\infty)^2$ with Lebesgue mean 
measure, the instantaneous rate at which we see such a $v$ will be
$2\gamma(X_{\tau'}(\tau'+s), \Xi(\tau'+s))\big(u_g-U_{\tau'}(\tau'+s)\big)$.
Comparing  this
with Equation
\eqref{Eq: Non-local Scaling limit Lookdown Generator}, this is exactly
the rate of births that we require.
\begin{remark}
Note in particular that $\ell=0$ in the deterministic limit , so the increment in Equation \eqref{Eq: expression for offspring level in limit} is always infinite, meaning that no new offspring is born in the deterministic model. 
\end{remark}
In order to write $X_\tau(t)$ and $U_\tau(t)$ as an integral along
the whole ancestral path linking individual $\tau$ to its ancestor at 
time $0$, we associate a counting process $N_{\tau}$ with the indivdual
$\tau$    
such that $N_{\tau}(t)$ gives the generation of the ancestor of $\tau$ 
that is alive at time $t$,
and a process $A_{\tau}$ such that 
$A_{\tau}(t)$ is 
the index of the ancestor of $\tau$ that is alive at time $t$. 
Finally, let $V_{\tau}(t)=\sum_{k=1}^{N_{\tau}(t)}v_k^{\tau}$ be the sum of the second 
coordinate of the Poisson points along the ancestral line 
leading to $\tau$.  Then we can write 
\begin{eqnarray*}
X_{\tau}(t)&=&X_{\mbox{\rm $A_{\tau}(0)$}}(0)+\int_0^t\sigma 
(X_{\tau}(s),\Xi (s))dW_{A_{\tau}(s)}(s)+\int_0^t\beta (X_{\tau}
(s),\Xi (s))ds,\\
U_{\tau}(t)&=&U_{A_{\tau}(0)}(0)+\int_0^t\frac 1{2\ell \gamma(X_{\tau}(s-),\varrho_\varepsilon*\Xi(X_{\tau}(s-))}dV_{\tau}(s)\\
&&\qquad\qquad +\int_{\tau}^t\bigg\{\ell \gamma(X_{\tau}(s),\varrho_\varepsilon*\Xi(X_{\tau}(s)U_{\tau}^2(s) \\
&&-\big(F(X_{\tau}(s), (\varrho_{\varepsilon}*\overline{\eta})(X_{\tau}(s)))+\gamma(X_{\tau}(s), (\varrho_{\varepsilon}*\Xi)(X_{\tau}(s)))\mathcal{B}r(\cdot,(\varrho_{\varepsilon}*\overline{\eta})(\cdot))(X_{\tau}(s))\big)U_{\tau}(s))\bigg\}ds,\end{eqnarray*}
where
\[\langle\Xi (t),\varphi\rangle =\lim_{\epsilon\rightarrow 0}
\epsilon\sum_{
\tau\leq t}e^{-\epsilon U_{\tau}(t)}\varphi (X_{\tau}(t)).\]

This representation of individuals allows us to identify all 
of the individuals in the current population that are descendants of a
given ancestor at time zero. In theory at least, this allows us to
recover all the information about genealogies relating individuals 
sampled from the present day population. This idea draws on the notion
of `tracers', popular in statistical physics and used in population
genetics by a number of authors including 
\cite{biswas/etheridge/klimek:2018, durrett/fan:2016, hallatschek/nelson:2008}.





%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Proofs}

\comment{
    TODO: write overview.
    To prove convergence, we'll be proving
    (a) tightness
    (b) convergence of generators, and
    (c) uniqueness of the limit.

    Then, to get convergence of the lookdown
    we use the population process (somehow).
}

\begin{proof}[Proof of Theorem~\ref{thm:nonlocal_convergence}.]

\comment{INSERT HERE
    narrative of tightness,
    proved in Section \ref{sec:population_tightness_proofs},
    and convergence of generators,
    proved in Section \ref{sec:population_generators_proofs}.
}

\end{proof}


% % % % % % % % % % % % %
\subsection{Tightness of empirical measures}
    \label{sec:population_tightness_proofs}

\begin{lemma}[Tightness for the population process]
    Something like:
    for all suitable $f$
    and initial states $\eta^\theta_0 \to \eta_0$,
    \begin{align}
        \IE\left[
            \sup_{0 \le t \le T}
            \langle f, \eta^\theta_t \rangle
        \right]
        \le C ,
    \end{align}
    uniformly in $\theta$.
\end{lemma}

\comment{In which we Gronwall $\langle 1, \eta_t\rangle$ and the like.}



% % % % % % % % % % % % %
\subsection{Convergence of generators}
    \label{sec:population_generators_proofs}

    \begin{lemma}[Convergence of generators for the population process]
        As $\theta \to \infty$,
        \comment{(the generator for the prelimit)}
        converges to
        \comment{(the generator for the limit)}.
    \end{lemma}

% % % % % % % % % % % % %
\subsection{Uniqueness of the limit}
    \label{sec:uniqueness_proofs}

Here are the proofs of Corollaries~\ref{cor:nonlocal_pde_limits}
and \ref{cor:superprocess_uniqueness},
giving conditions in which the limiting process is unique
(in which case we have convergence, not just on subsequences).


% % % % % % % % % % % % %
\subsection{Convergence of the nonlocal equation to the local equation}

\comment{... for the cases in which we know this.
This then shows that we can take the local, deterministic limit
by taking $\theta, N \to \infty$ first, and then $\epsilon \to 0$ after.
}

In this section we prove Proposition~\ref{prop:nonlocal_pde_limits}.


% % % % % % % % % % % % %
\subsection{Simultaneous scaling with interaction distance}

\comment{
    Convergence of generators along (something like) the diagonal,
    taking $\epsilon \to 0$ at the same time as the other coefficient.
    (We won't prove tightness here.)
}

In this section we prove Theorem~\ref{them:nonlocal_pde_limits}.



% % % % % % % % % % % % %
\subsection{Proof of convergence for the lookdown process}

The proof of the main result in Section~\ref{sec:lookdown}.

This will depend on Sections~\ref{sec:lookdown_tightness_proofs}
and \ref{sec:lookdown_generator_proofs}.


% % % % % % % % % % % % %
\subsection{Tightness of the lookdown process}
    \label{sec:lookdown_tightness_proofs}

\comment{
    This comes later because it uses convergence of the population process itself.
}


% % % % % % % % % % % % %
\subsection{Convergence of generators for the lookdown process}
    \label{sec:lookdown_generator_proofs}



% % % % % % % % % % % % %
\subsection{Motion of ancestral lineages}

In this section we prove Theorem~\ref{thm:lineages}.
The argument follows directly from the discussion in Section \ref{sec:lines_of_descent}
(and so maybe actually that content should be down here).

\begin{proof}[of Theorem~\ref{thm:lineages}]
    \comment{
        This is actually copied over the proof of Corollary~\ref{cor:wavefront};
        TODO is to generalize it to time-varying density.
    }

Let $Y$ denote the diffusion followed by following a single descendent line in this frame; 
i.e.~the diffusion with generator ${\cal L}^Y\phi=\gamma\Delta(r\phi)-\gamma\phi\Delta r -\mathfrak{c}\nabla\phi $. Note in particular here we take $\mathcal{B}=\Delta$. We start by expressing the evolution of a singles ancestry line in terms of the descendent line $Y$.

Formally, the intensity of levels at $y$ at time $t$ that are descended from 
individuals that were at $x$ at time $0$ is
\begin{equation}
\label{formal intensity}
w(x)\IE_x\left[\exp\left(\int_0^t (F+\gamma \Delta r)(Y_s)ds\right)\ind_{Y_t=y}\right]dy,
\end{equation}
where the subscript $x$ in the expectation indicates that $Y_0=x$.
To see why this should be true, 
suppose that an ancestor has level $u$. Conditional on its 
spatial motion $\{Y_s\}_{0\leq s\leq t}$, its level at time $t$ will
be $u\exp(-\int_0^t(F+\gamma\Delta r)(Y_s)ds)$. This will be less than a given level 
$\lambda$ if $u<\lambda \exp(\int_0^t(F+\gamma\Delta r)(Y_s)ds)$. 
The intensity of levels at $y$ that are descended from individuals at
$x$ can therefore be obtained as the limit as $\lambda\to\infty$ of 
$1/\lambda$ times the number of levels at $x$ at time zero with
$u<\lambda \exp(\int_0^t(F+\gamma\Delta r)(Y_s)ds)$ and for which
the corresponding individual is at $y$ at time $t$, which is 
precisely the quantity in~(\ref{formal intensity}). 

It is easy to check that when we integrate~(\ref{formal intensity})
with respect to $x$ we recover $w(y)dy$. 
As a consequence of~(\ref{formal intensity}), writing $p(t,y,x)$ for
the probability density that the ancestor $t$ units in 
the past of an individual sampled 
at $y$ was at $x$, then, still formally,
\begin{equation}
\label{ptyx}
p(t,y,x)=\frac{w(x)}{w(y)}\IE_x\left[\exp\left(\int_0^t (F+\gamma\Delta r)(Y_s)ds\right)
\ind_{Y_t=y}\right].
\end{equation}

To make~(\ref{ptyx}) meaningful, we multiply by suitable test functions and 
integrate.
$$\int\int \psi(y)w(y)p(t,y,x)\phi(x)dydx=\int\phi(x)w(x)
\IE_x\left[\exp\left(\int_0^t(F+\gamma\Delta r)(Y_s)ds\right)\psi(Y_t)\right]dydx.$$

Writing $\hat{T}_t$ for the semigroup corresponding to the motion of 
ancestral lineages backwards in time (that is the semigroup corresponding
to $p(t,x,y)$), we can write this as 
$$\int \psi(y)w(y)\hat{T}_t\phi(y)dy=\int\phi(x)w(x)
\IE_x\left[\exp\left(\int_0^t(F+\gamma\Delta r)(Y_s)ds\right)\psi(Y_t)\right]dx.$$
Differentiating with respect to $t$ at $t=0$, and writing 
$\hat{\mathcal L}$ for the generator of $\hat{T}_t$, we find
\begin{eqnarray*}
\int \psi(y)w(y)\widehat{\mathcal L}\phi(y)dy&=&
\int\phi(x)w(x)\left({\mathcal L}^Y\psi(x)+\psi(x)(F+\gamma\Delta r)\psi(x)\right)dx\\
&=&\int\phi(x)w(x)\left(\gamma\Delta(r\psi)-\gamma\psi\Delta r -\mathfrak{c}\nabla\psi 
+(F+\gamma\Delta r)(\psi)\right)dx\\
&=&\int\phi(x)w(x)\left(\gamma\Delta(r\psi)-\mathfrak{c}\nabla\psi+F(\psi)\right)dx\\
&=&
\int\psi(x)\left[r\Delta(\gamma \phi w)+F\phi w+\mathfrak{c}\nabla(\phi w)\right]dx.
\end{eqnarray*}
Since $\psi$ was arbitrary,
\begin{eqnarray*}
\hat{\mathcal L}\phi&=&\frac{1}{w}\left[ r\Delta (\gamma\phi w)+F\phi w
+\mathfrak{c}\nabla(\phi w)\right]\\
&=&\frac{\phi}{w}\left[r\Delta(\gamma w)+Fw+\mathfrak{c}\nabla w\right]
+\frac{1}{w}\left[r\gamma w\Delta \phi +2\nabla (\gamma w)
\nabla\phi+\mathfrak{c}w\nabla\phi\right]\\
&=&r\gamma\left(\Delta\phi+2\frac{\nabla(\gamma w)}{\gamma w}\nabla\phi\right)
+\mathfrak{c}\nabla\phi,
\end{eqnarray*}
where we have used that $w$ solves~(\ref{profile}).

\end{proof}



\bibliographystyle{plainnat}
\bibliography{refs.bib}


\end{document}
